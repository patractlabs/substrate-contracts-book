"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3629],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return n?a.createElement(h,i(i({ref:t},p),{},{components:n})):a.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},1488:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return p},default:function(){return u}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],s={},l="Basics",c={unversionedId:"ask/basics",id:"ask/basics",isDocsHomePage:!1,title:"Basics",description:"Ask! provides the ask-lang package, which includes the implementation of common storage types in contracts, the encapsulation of the underlying primitives of smart contracts, etc.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/ask/basics.md",sourceDirName:"ask",slug:"/ask/basics",permalink:"/en/ask/basics",editUrl:"https://github.com/patractlabs/substrate-contracts-book/docs/ask/basics.md",version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Design",permalink:"/en/ask/design"},next:{title:"Ask! decorator",permalink:"/en/ask/decorators"}},p=[{value:"Storage",id:"storage",children:[{value:"Built-in storage type",id:"built-in-storage-type",children:[]},{value:"Define the storage type",id:"define-the-storage-type",children:[]},{value:"Initialize the storage type",id:"initialize-the-storage-type",children:[]},{value:"Read the storage value",id:"read-the-storage-value",children:[]},{value:"Modify the storage value",id:"modify-the-storage-value",children:[]},{value:"Events",id:"events",children:[]},{value:"Example",id:"example",children:[]},{value:"Chain environment function",id:"chain-environment-function",children:[]}]}],d={toc:p};function u(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"basics"},"Basics"),(0,o.kt)("p",null,"Ask! provides the ",(0,o.kt)("inlineCode",{parentName:"p"},"ask-lang")," package, which includes the implementation of common storage types in contracts, the encapsulation of the underlying primitives of smart contracts, etc."),(0,o.kt)("h2",{id:"storage"},"Storage"),(0,o.kt)("h3",{id:"built-in-storage-type"},"Built-in storage type"),(0,o.kt)("p",null,"Ask! provides a version that supports Scale encoding and storage for the basic types of ",(0,o.kt)("a",{parentName:"p",href:"https://www.assemblyscript.org/"},"AssemblyScript")," and standard library collections,\nIncluding ",(0,o.kt)("inlineCode",{parentName:"p"},"bool"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"i{8, 16, 32, 64, 128}"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"u{8, 16, 32, 64, 128}"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"string(String)"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"Array"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"Set"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"Map"),",\nCorresponds to ",(0,o.kt)("inlineCode",{parentName:"p"},"Bool"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"Int{8, 16, 32, 64, 128}"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"u{8, 16, 32, 64, 128}"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"ScaleString"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"ScaleArray"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"ScaleSet"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"ScaleMap"),"."),(0,o.kt)("p",null,"When the basic types mentioned above are used in relevant positions in the contract code (but not including container types such as ",(0,o.kt)("inlineCode",{parentName:"p"},"Array"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"Set"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"Map"),"), Ask! It will be automatically converted to the corresponding Scale type (that is, automatic boxing/unboxing) during compile time."),(0,o.kt)("p",null,"You can import ",(0,o.kt)("inlineCode",{parentName:"p"},"Bool")," via ",(0,o.kt)("inlineCode",{parentName:"p"},"ask-lang"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { Bool } from 'ask-lang';\n")),(0,o.kt)("h3",{id:"define-the-storage-type"},"Define the storage type"),(0,o.kt)("p",null,"Ask! provides ",(0,o.kt)("inlineCode",{parentName:"p"},"@storage")," to decorate the class as a storage type."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"@storage\nclass Storage {\n    // Store a bool\n    b: bool;\n    // Store a number\n    n: i32,\n}\n")),(0,o.kt)("p",null,"Ask! provides ",(0,o.kt)("inlineCode",{parentName:"p"},"@storage")," to decorate the class as a storage type, and the fields in the storage type need to support  ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/paritytech/parity-scale-codec"},"Scale encoding"),"."),(0,o.kt)("h3",{id:"initialize-the-storage-type"},"Initialize the storage type"),(0,o.kt)("p",null,"We can initialize the stored value in the contract initialization constructor. The contract class must provide at least one initialization function decorated by ",(0,o.kt)("inlineCode",{parentName:"p"},"@constructor"),". The example is as follows."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"@contract\nclass MyContract {\n  num: i32;\n\n  constructor() {\n    this.num = 0;\n  }\n\n  @constructor\n  init(num: i32): void {\n    this.num = num;\n  }\n}\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note")," The default constructor ",(0,o.kt)("inlineCode",{parentName:"p"},"@constructor")," must be public, otherwise a compilation error will appear. The parameters and return value of the contract function must be a basic type or a type that implements Codec encoding."),(0,o.kt)("h3",{id:"read-the-storage-value"},"Read the storage value"),(0,o.kt)("p",null,"Ask!\u2019s storage and contract can be declared separately, and it is also recommended that you declare them separately. The function declared in the contract class is the real external contract API, and storage is only the implementation details."),(0,o.kt)("h3",{id:"modify-the-storage-value"},"Modify the storage value"),(0,o.kt)("p",null,"Ask! provides the ",(0,o.kt)("inlineCode",{parentName:"p"},"mutates")," property for the ",(0,o.kt)("inlineCode",{parentName:"p"},"@message")," method, which defaults to ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),". When set to ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),", the method will refuse to modify the stored value at runtime."),(0,o.kt)("h3",{id:"events"},"Events"),(0,o.kt)("p",null,"Smart contracts can define events that can be emitted during contract execution, and third-party tools can use emitted events to query information about contract execution and status. Event fields must implement the ",(0,o.kt)("inlineCode",{parentName:"p"},"Codec")," interface, they will be collected as event data, and the fields decorated by ",(0,o.kt)("inlineCode",{parentName:"p"},"@topic")," will also serve as the index of the event."),(0,o.kt)("h3",{id:"example"},"Example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"@event\nclass Transfer {\n  @topic\n  from: AccountId;\n  @topic\n  to: AccountId;\n\n  value: u128;\n\n  constructor(from: AccountId, to: AccountId, value: u128) {\n    this.from = from;\n    this.to = to;\n    this.value = value;\n  }\n}\n")),(0,o.kt)("p",null,"When the ",(0,o.kt)("inlineCode",{parentName:"p"},"@event")," class is instantiated, ",(0,o.kt)("inlineCode",{parentName:"p"},"deposit_event")," is automatically called internally."),(0,o.kt)("h3",{id:"chain-environment-function"},"Chain environment function"),(0,o.kt)("p",null,"Ask! provides some classes whose methods provide APIs for the capabilities provided by the chain."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Crypto: Provides APIs related to encryption."),(0,o.kt)("li",{parentName:"ul"},"Gas: Provides APIs related to Gas."),(0,o.kt)("li",{parentName:"ul"},"AccountId: Provides APIs related to accounts."),(0,o.kt)("li",{parentName:"ul"},"Msg: Provides APIs related to messages.")))}u.isMDXComponent=!0}}]);