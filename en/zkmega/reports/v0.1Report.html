<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Report for zkMega v0.1（original Megaclite v0.1 )</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/substrate-contracts-book/favicon.ico">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta content="https://www.patract.io/social-preview.png" property="og:image">
    
    <link rel="preload" href="/substrate-contracts-book/assets/css/0.styles.7869a774.css" as="style"><link rel="preload" href="/substrate-contracts-book/assets/js/app.0512fc9b.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/3.7c35afa4.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/1.293685b3.js" as="script"><link rel="preload" href="/substrate-contracts-book/assets/js/134.9e9d0921.js" as="script"><link rel="prefetch" href="/substrate-contracts-book/assets/js/10.f560e2ba.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/100.0153f1c5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/101.36938e7b.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/102.54808992.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/103.76f65bdf.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/104.f0d72cbc.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/105.112a1cd8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/106.1587302e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/107.658c4109.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/108.e3aee840.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/109.7d1d01d0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/11.ff45929c.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/110.cc5d0673.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/111.5230de15.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/112.be290b70.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/113.e6e0ad48.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/114.c37ff266.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/115.8552a903.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/116.003a2b6d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/117.6cd0c2e0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/118.a14d9fe0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/119.5974d5e6.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/12.7661745e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/120.a2312c75.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/121.c6991041.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/122.83d8f05d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/123.6924f433.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/124.d62a0b42.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/125.e61300d0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/126.7e765e24.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/127.107411da.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/128.20e2adce.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/129.288a6f52.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/13.77735261.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/130.e2a72c48.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/131.bd67efe9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/132.7b2c7f53.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/133.75bfcf2e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/135.324b5294.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/136.007179e8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/137.4ec2ff40.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/138.649c3481.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/139.eed3baec.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/14.0d64657c.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/140.1bc025aa.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/141.a9b85db3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/142.0768749f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/143.93f6b8c4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/144.9d6912b9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/145.c3cf0077.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/146.b726dd3a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/147.b6f59662.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/148.d9951318.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/149.6243d82d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/15.98e78daf.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/150.d498300a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/151.3d58f099.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/152.085723d8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/153.4f9e18ab.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/154.c8662863.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/155.df6801d9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/156.46d6f734.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/157.e8092950.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/158.eb3a79bb.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/159.ead4a729.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/16.61021424.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/160.28644c7a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/161.6d2fa557.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/162.0477f850.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/163.6cf93396.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/164.5cba28b4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/165.13b50224.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/166.d6adf620.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/167.4a495566.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/168.c312f322.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/169.f37ba1c5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/17.58bc9af7.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/170.b3fe4043.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/171.228202e7.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/172.72965f5a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/173.7d24d201.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/174.7a99c279.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/175.906adcdd.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/176.54af4560.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/177.024eecb8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/178.5f07b111.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/179.53a38f63.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/18.176e469c.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/180.26ecf2c3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/181.dce99ceb.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/182.e6382439.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/183.fefb1495.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/184.ebdea99c.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/185.3a32ea37.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/186.079185d8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/187.bbc2ad09.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/188.20490eb3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/189.9d80c9c5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/19.0a0963f9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/190.3fd647b5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/191.c0a38f33.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/192.162e93ef.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/193.077b12e2.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/194.6e022708.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/195.43d1f100.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/196.51d8982f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/197.67276d19.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/20.c67e51a2.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/21.e1b4d15d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/22.e7c6af88.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/23.bcf6fd6b.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/24.82bd5bb7.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/25.d7485964.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/26.d6ba03d4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/27.59b07548.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/28.1c175f18.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/29.ed7481c9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/30.548c38ca.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/31.868ea504.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/32.3b2de66a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/33.9f45019d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/34.ab7d0792.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/35.c6cb45a8.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/36.ecf0aae1.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/37.689dfb9d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/38.f405b266.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/39.cfed4e29.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/4.e9bde0d3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/40.808c28db.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/41.3403c3a3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/42.73c3b656.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/43.4c43aac1.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/44.3584f9fc.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/45.cdebf294.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/46.654ba434.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/47.95c2825d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/48.a400ea64.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/49.ac93bc37.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/5.271970b3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/50.47b55d1a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/51.06054c5e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/52.3ce7dff4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/53.6f5b2f0c.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/54.e0eeacb3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/55.793777c2.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/56.7905359e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/57.006b682e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/58.b72084bb.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/59.e66054a1.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/6.1380e490.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/60.86ebaf5a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/61.f4f61013.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/62.59762ee0.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/63.5ae468f9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/64.232b4447.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/65.e77ea092.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/66.6c7580d3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/67.0886e149.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/68.9d055d69.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/69.d8da1686.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/7.609a6697.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/70.75e3ce43.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/71.5be06d5f.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/72.c4d23bfc.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/73.5e924bea.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/74.3c7635ac.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/75.280dd380.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/76.80c841c4.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/77.40b985cc.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/78.6bde6f3a.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/79.ecc021f3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/8.f877c3e5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/80.fbbb0add.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/81.ee0758d6.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/82.eba646ec.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/83.c5dcad7d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/84.b9a61f11.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/85.8227c486.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/86.2e717c4e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/87.d48572e3.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/88.14b3ad70.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/89.777a3bb2.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/9.2035d6c9.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/90.24b6a32d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/91.ed9e9e96.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/92.0320c66d.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/93.2800c95e.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/94.65591368.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/95.16c6aac6.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/96.3d21803c.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/97.bcc392bb.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/98.f0db5ce5.js"><link rel="prefetch" href="/substrate-contracts-book/assets/js/99.e85d78fe.js">
    <link rel="stylesheet" href="/substrate-contracts-book/assets/css/0.styles.7869a774.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc></h3> <p class="description" data-v-4e82dffc data-v-4e82dffc></p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>patractlabs</span>
            
          <!---->
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/substrate-contracts-book/en/" class="home-link router-link-active"><img src="/substrate-contracts-book/logo.svg" alt="" class="logo"> <!----></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://patract.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-home"></i>
  Official Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://blog.patract.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-blog"></i>
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/substrate-contracts-book/en/" class="nav-link"><i class="undefined"></i>
  Doc
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/substrate-contracts-book/zkmega/reports/v0.1Report.html" class="nav-link"><i class="undefined"></i>
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="undefined"></i>
  English
</a></li></ul></div></div> <a href="https://github.com/patractlabs/substrate-contracts-book" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><!----> <h3 class="name" data-v-828910c6>
    patractlabs
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>188</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>0</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="https://patract.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-home"></i>
  Official Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://blog.patract.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-blog"></i>
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/substrate-contracts-book/en/" class="nav-link"><i class="undefined"></i>
  Doc
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/substrate-contracts-book/zkmega/reports/v0.1Report.html" class="nav-link"><i class="undefined"></i>
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="undefined"></i>
  English
</a></li></ul></div></div> <a href="https://github.com/patractlabs/substrate-contracts-book" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <ul class="sidebar-links"><li><a href="/substrate-contracts-book/en/" aria-current="page" class="sidebar-link">Summary</a></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/introduction" class="sidebar-heading clickable"><span>Introduction</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/contracts/overview.html" class="sidebar-link">Contract overview</a></li><li><a href="/substrate-contracts-book/en/contracts/model.html" class="sidebar-link">Contract model</a></li><li><a href="/substrate-contracts-book/en/contracts/language.html" class="sidebar-link">Contract language</a></li><li><a href="/substrate-contracts-book/en/contracts/wasm_first_step.html" class="sidebar-link">Brief introduction of Wasm</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/ink/introduction" class="sidebar-heading clickable"><span>ink!</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/ink/tutorial.html" class="sidebar-link">ink! tutorial</a></li><li><a href="/substrate-contracts-book/en/ink/framework.html" class="sidebar-link">ink! Framework</a></li><li><a href="/substrate-contracts-book/en/ink/edsl-basic.html" class="sidebar-link">ink! eDSL basic elements</a></li><li><a href="/substrate-contracts-book/en/ink/call-contracts.html" class="sidebar-link">Cross-call for ink!</a></li><li><a href="/substrate-contracts-book/en/ink/ink-solidity.html" class="sidebar-link">Compare ink! and solidity</a></li><li><a href="/substrate-contracts-book/en/ink/cargo-contract.html" class="sidebar-link">cargo-contract</a></li><li><a href="/substrate-contracts-book/en/ink/trap.html" class="sidebar-link">Current problem for ink!</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/ask/introduction" class="sidebar-heading clickable"><span>ask!</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/ask/tutorial.html" class="sidebar-link">Getting Started</a></li><li><a href="/substrate-contracts-book/en/ask/design.html" class="sidebar-link">Design</a></li><li><a href="/substrate-contracts-book/en/ask/basics.html" class="sidebar-link">Basics</a></li><li><a href="/substrate-contracts-book/en/ask/decorators.html" class="sidebar-link">Ask! decorator</a></li><li><a href="/substrate-contracts-book/en/ask/storage-data-structure.html" class="sidebar-link">Storage</a></li><li><a href="/substrate-contracts-book/en/ask/ask-cli.html" class="sidebar-link">Ask-cli</a></li><li><a href="/substrate-contracts-book/en/ask/ask-vs-ink.html" class="sidebar-link">Ask! and ink! Comparison of characteristics</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/ask/reports" class="sidebar-heading clickable"><span>Report</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/ask/reports/v0.1Report.html" class="sidebar-link">Report for Ask! v0.1</a></li><li><a href="/substrate-contracts-book/en/ask/reports/v0.2Report.html" class="sidebar-link">Report for Ask! v0.2</a></li></ul></section></li></ul></section></li><li><a href="/substrate-contracts-book/en/solang/introduction.html" class="sidebar-link">Solang</a></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/redspot/introduction" class="sidebar-heading clickable"><span>Redspot</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/redspot/tutorial.html" class="sidebar-link">Redspot tutorial</a></li><li><a href="/substrate-contracts-book/en/redspot/overview.html" class="sidebar-link">Introduction</a></li><li><a href="/substrate-contracts-book/en/redspot/configuration.html" class="sidebar-link">Configuration information</a></li><li><a href="/substrate-contracts-book/en/redspot/tasks.html" class="sidebar-link">Tasks</a></li><li><a href="/substrate-contracts-book/en/redspot/runtime-environment.html" class="sidebar-link">Runtime Environment</a></li><li><a href="/substrate-contracts-book/en/redspot/console.html" class="sidebar-link">Console</a></li><li><a href="/substrate-contracts-book/en/redspot/q-and-a.html" class="sidebar-link">Common problem</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/redspot/plugin" class="sidebar-heading clickable"><span>Plugin</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/redspot/plugin/redspot-decimals.html" class="sidebar-link">@redspot_decimals plug-in</a></li><li><a href="/substrate-contracts-book/en/redspot/plugin/redspot-known-types.html" class="sidebar-link">@redspot_known-types plug-in</a></li><li><a href="/substrate-contracts-book/en/redspot/plugin/redspot-chai.html" class="sidebar-link">@redspot_chai  plug-in</a></li><li><a href="/substrate-contracts-book/en/redspot/plugin/redspot-gas-reporter.html" class="sidebar-link">@redspot_gas-reporter plug-in</a></li><li><a href="/substrate-contracts-book/en/redspot/plugin/redspot-patract.html" class="sidebar-link">@redspot_patract plug-in</a></li><li><a href="/substrate-contracts-book/en/redspot/plugin/redspot-explorer.html" class="sidebar-link">@redspot_explorer plug-in</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/redspot/reports" class="sidebar-heading clickable"><span>Report</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/redspot/reports/v0.1Report.html" class="sidebar-link">Report for Redspot v0.1</a></li><li><a href="/substrate-contracts-book/en/redspot/reports/v0.2Report.html" class="sidebar-link">Report for Redspot v0.2</a></li><li><a href="/substrate-contracts-book/en/redspot/reports/v0.3Report.html" class="sidebar-link">Report for Redspot v0.3</a></li><li><a href="/substrate-contracts-book/en/redspot/reports/v0.4Report.html" class="sidebar-link">Report for Redspot v0.4</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/europa/introduction" class="sidebar-heading clickable"><span>Europa</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/europa/tutorial.html" class="sidebar-link">Europa tutorial</a></li><li><a href="/substrate-contracts-book/en/europa/execution_info.html" class="sidebar-link">Europa contract execution log analysis</a></li><li><a href="/substrate-contracts-book/en/europa/sample.html" class="sidebar-link">Europa debugging example</a></li><li><a href="/substrate-contracts-book/en/europa/wasm_executor.html" class="sidebar-link">Europa Wasm executor</a></li><li><a href="/substrate-contracts-book/en/europa/wasm_backtrace.html" class="sidebar-link">Europa's Wasm Backtrace</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/europa/reports" class="sidebar-heading clickable"><span>Report</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/europa/reports/v0.1Report.html" class="sidebar-link">Report for Europa v0.1</a></li><li><a href="/substrate-contracts-book/en/europa/reports/v0.2Report.html" class="sidebar-link">Report for Europa v0.2</a></li><li><a href="/substrate-contracts-book/en/europa/reports/v0.3Report.html" class="sidebar-link">Report for Europa v0.3</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/zkmega/introduction" class="sidebar-heading clickable"><span>zkMega</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/zkmega/tutorial.html" class="sidebar-link">tutorial</a></li><li><a href="/substrate-contracts-book/en/zkmega/contract.html" class="sidebar-link">Contract</a></li><li><a href="/substrate-contracts-book/en/zkmega/example.html" class="sidebar-link">Example</a></li><li><a href="/substrate-contracts-book/en/zkmega/benchmark.html" class="sidebar-link">Benchmark</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/zkmega/reports" class="sidebar-heading clickable router-link-active open"><span>Report</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html" aria-current="page" class="active sidebar-link">Report for zkMega v0.1（original Megaclite v0.1 )</a></li><li><a href="/substrate-contracts-book/en/zkmega/reports/v0.2Report.html" class="sidebar-link">Report for zkMega v0.2（original Megaclite v0.2 )</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/himalia/introduction" class="sidebar-heading clickable"><span>Himalia</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/himalia/tutorial.html" class="sidebar-link">tutorial</a></li><li><a href="/substrate-contracts-book/en/himalia/go-patract.html" class="sidebar-link">go-patract</a></li><li><a href="/substrate-contracts-book/en/himalia/py-patract.html" class="sidebar-link">py-patract</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/himalia/reports" class="sidebar-heading clickable"><span>Report</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/himalia/reports/v0.1Report.html" class="sidebar-link">Report for  Himalia v0.1 &amp; v0.2</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/metis/introduction" class="sidebar-heading clickable"><span>Metis</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/metis/tokens.html" class="sidebar-link">ERC20</a></li><li><a href="/substrate-contracts-book/en/metis/access-control.html" class="sidebar-link">Access Control</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/metis/reports" class="sidebar-heading clickable"><span>Report</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/metis/reports/M1Report.html" class="sidebar-link">Patract's proposal about Metis (ink! and Ask! Standard Library)</a></li></ul></section></li></ul></section></li><li><a href="/substrate-contracts-book/en/carpo/introduction.html" class="sidebar-link">Carpo</a></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/elara/introduction" class="sidebar-heading clickable"><span>Elara</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/elara/tutorial.html" class="sidebar-link">Tutorial</a></li><li><a href="/substrate-contracts-book/en/elara/design.html" class="sidebar-link">Design Brief</a></li><li><a href="/substrate-contracts-book/en/elara/API.html" class="sidebar-link">API access</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/substrate-contracts-book/en/elara/reports" class="sidebar-heading clickable"><span>Report</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/elara/reports/v0.1Report.html" class="sidebar-link">Report for Elara v0.1</a></li><li><a href="/substrate-contracts-book/en/elara/reports/v0.2Report.html" class="sidebar-link">Report for Elara v0.2</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/jupiter/introduction" class="sidebar-heading clickable"><span>Jupiter</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/jupiter/quickstart.html" class="sidebar-link">编译</a></li><li><a href="/substrate-contracts-book/jupiter/network.html" class="sidebar-link">Jupiter 网络</a></li><li><a href="/substrate-contracts-book/jupiter/contract.html" class="sidebar-link">合约</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/substrate-contracts-book/en/patra-store/introduction" class="sidebar-heading clickable"><span>PatraStore</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/substrate-contracts-book/en/patra-store/overview.html" class="sidebar-link">Overview</a></li><li><a href="/substrate-contracts-book/en/patra-store/getting-starter.html" class="sidebar-link">Getting started</a></li><li><a href="/substrate-contracts-book/en/patra-store/publish-dapps.html" class="sidebar-link">Publish DApp</a></li></ul></section></li><li><a href="/substrate-contracts-book/en/patract/introduction.html" class="sidebar-link">Patract</a></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc></h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>patractlabs</span>
            
          <!---->
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">Report for zkMega v0.1（original Megaclite v0.1 )</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>patractlabs</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="report-for-zkmega-v0-1-original-megaclite-v0-1"><a href="#report-for-zkmega-v0-1-original-megaclite-v0-1" class="header-anchor">#</a> Report for zkMega v0.1（original Megaclite v0.1 )</h1> <p>5 weeks ago, <a href="https://patract.io" target="_blank" rel="noopener noreferrer">Patract Hub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> applied a <a href="https://polkadot.polkassembly.io/treasury/24" target="_blank" rel="noopener noreferrer">treasury proposal #24<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for Megaclite v0.1. Megaclite project will be dedicated to introducing basic zero-knowledge proof underlying support for the Polkadot ecology, so that developers can easily develop applications at the upper level through WASM smart contracts or Runtime.</p> <p>Now, we have finished all the works of v0.1 and you can review our source code at those repos. We will introduce more details at the following report.</p> <ul><li>ZKP library: https://github.com/patractlabs/megaclite</li> <li>Testnet example: https://github.com/patractlabs/jupiter</li> <li>Contract example: https://github.com/patractlabs/metis</li></ul> <h2 id="_1-recap-of-megaclite-s-development-plan-v0-1-v0-3"><a href="#_1-recap-of-megaclite-s-development-plan-v0-1-v0-3" class="header-anchor">#</a> 1. Recap of Megaclite’s development plan (v0.1 ~ v0.3)</h2> <ul><li><s>v0.1: Provide on-chain support for elliptic curve alt_bn128 and bls12_381 and bls12-377, bw6_761</s> <ul><li>Integrate addition (ADD), scalar multiplication (MUL) and Pairing functions of the curves in Native layer and Runtime WASM layer.</li> <li>Provide these three functions to the upper Runtime Pallets and Contracts to call.</li> <li>In the Runtime layer and the Ink! contract layer, provide two zkSNARK Verify upper-layer interfaces ( verification function of groth16, similar to the Verifier library of  <a href="https://github.com/HarryR/ethsnarks" target="_blank" rel="noopener noreferrer">ethsnarks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ).</li> <li>Start the Metis project and implement EdDSA, MerkleTree, MiMC Hash, etc. contract library on the Ink! contract layer.</li></ul></li> <li>v0.2: Provide off-chain toolbox support for Ink! contract</li> <li>v0.3: Create a sample payment DApp based on Megaclite</li></ul> <h2 id="_2-support-and-benchmark-basic-units-in-native-layer-and-wasm-layer"><a href="#_2-support-and-benchmark-basic-units-in-native-layer-and-wasm-layer" class="header-anchor">#</a> 2. Support and benchmark basic units in Native layer and WASM layer.</h2> <h3 id="_2-1-encapsulate-crypto-units-of-the-four-curves-from-arkworks"><a href="#_2-1-encapsulate-crypto-units-of-the-four-curves-from-arkworks" class="header-anchor">#</a> 2.1 Encapsulate crypto units of the four curves from arkworks</h3> <ul><li>Arkworks library: https://github.com/arkworks-rs/curves.</li> <li>Source: <a href="https://github.com/patractlabs/megaclite/blob/master/crates/curve/arkworks/src/ops.rs" target="_blank" rel="noopener noreferrer">megaclite/blob/master/crates/curve/arkworks/src/ops.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Test cases: <a href="https://github.com/patractlabs/megaclite/tree/master/crates/curve/arkworks/src/tests" target="_blank" rel="noopener noreferrer">megaclite/tree/master/crates/curve/arkworks/src/tests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>We inherited the <code>PairingEngine</code> trait through the <code>CurveBasicOperations</code> trait and combined the three methods of ADD, MUL, and Pairings:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">SerializationError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> \\omit <span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">mul</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">SerializationError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> \\omit <span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">pairings</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">,</span> <span class="token class-name">SerializationError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> \\omit <span class="token punctuation">}</span>
</code></pre></div><p>Three of the methods are exposed to the Runtime and ink! layers with byte slice interfaces. ADD and MUL return elliptic curve points in byte vector. Pairings are internally paired and accumulated in batches, and the result is then compared with <code>Fqk::one()</code>. Return true if they are equal, otherwise just return.</p> <p>The <code>CurveBasicOperations</code> trait also encapsulates some different elliptic curve parameters needed to write groth16 verification code:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// curve basic parameters</span>
<span class="token keyword">const</span> <span class="token constant">SCALAR_FIELD</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">MODULUS</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// G1 bytes length</span>
<span class="token keyword">const</span> <span class="token constant">G1_LEN</span><span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">;</span>
<span class="token comment">// G2 bytes length</span>
<span class="token keyword">const</span> <span class="token constant">G2_LEN</span><span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">;</span>
<span class="token comment">// Scalar bytes length</span>
<span class="token keyword">const</span> <span class="token constant">SCALAR_LEN</span><span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">;</span>
<span class="token comment">// Curve ID is used for adaptation chain extension </span>
<span class="token keyword">const</span> <span class="token constant">CURVE_ID</span><span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-2-import-megaclite-through-host-calls-in-native-layer"><a href="#_2-2-import-megaclite-through-host-calls-in-native-layer" class="header-anchor">#</a> 2.2 Import Megaclite through host calls in Native layer.</h3> <ul><li>Example：<a href="https://github.com/patractlabs/jupiter/blob/features/runtime-interfaces/primitives/io/src/lib.rs" target="_blank" rel="noopener noreferrer">jupiter/blob/features/runtime-interfaces/primitives/io/src/lib.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">/// Pairing runtime interface</span>
<span class="token attribute attr-name">#[runtime_interface]</span>
<span class="token keyword">pub</span> <span class="token keyword">trait</span> <span class="token class-name">Pairing</span> <span class="token punctuation">{</span>
    <span class="token comment">/// | curve     | add        | mul        | pairing    |</span>
    <span class="token comment">/// |-----------|------------|------------|------------|</span>
    <span class="token comment">/// | bls12_377 | 0x01000000 | 0x01000001 | 0x01000002 |</span>
    <span class="token comment">/// | bls12_381 | 0x01000010 | 0x01000011 | 0x01000012 |</span>
    <span class="token comment">/// | bn254     | 0x01000020 | 0x01000021 | 0x01000022 |</span>
    <span class="token comment">/// | bw6_761   | 0x01000030 | 0x01000031 | 0x01000032 |</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">call</span><span class="token punctuation">(</span>func_id<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
        <span class="token namespace">curve<span class="token punctuation">::</span></span><span class="token function">call</span><span class="token punctuation">(</span>func_id<span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-3-import-megaclite-as-runtime-library-in-wasm-layer"><a href="#_2-3-import-megaclite-as-runtime-library-in-wasm-layer" class="header-anchor">#</a> 2.3 Import Megaclite as Runtime library in WASM layer</h3> <ul><li>Example：<a href="https://github.com/patractlabs/jupiter/blob/features/runtime-interfaces/pallets/template/src/lib.rs" target="_blank" rel="noopener noreferrer">jupiter/blob/features/runtime-interfaces/pallets/template/src/lib.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token comment"># Cargo.toml</span>
<span class="token punctuation">[</span><span class="token table class-name">dependencies.curve</span><span class="token punctuation">]</span>
<span class="token key property">package</span> <span class="token punctuation">=</span> <span class="token string">&quot;megaclite-arkworks&quot;</span>
<span class="token key property">git</span> <span class="token punctuation">=</span> <span class="token string">&quot;https://github.com/patractlabs/megaclite.git&quot;</span>
<span class="token key property">features</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;tests&quot;</span><span class="token punctuation">]</span>
<span class="token key property">default-features</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
</code></pre></div><p><code>megaclite-arkworks</code> supports <code>no_std</code>，so we can import it directly in Runtime layer.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">//! lib.rs</span>
<span class="token macro property">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token attribute attr-name">#[weight = 10_000 + T::DbWeight::get().writes(1)]</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">wasm_bls12_377_add</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token namespace">curve<span class="token punctuation">::</span>tests<span class="token punctuation">::</span></span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0x2a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-4-benchmark-of-basic-units"><a href="#_2-4-benchmark-of-basic-units" class="header-anchor">#</a> 2.4 Benchmark of basic units</h3> <p>You can build the program like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Clone the branch `curve-benchmark` of our fork</span>
<span class="token function">git</span> clone https://github.com/patractlabs/jupiter.git <span class="token punctuation">\</span>
    --branch features/runtime-interfaces <span class="token punctuation">\</span>
    --depth<span class="token operator">=</span><span class="token number">1</span>

<span class="token comment"># Build the template</span>
<span class="token builtin class-name">cd</span> jupiter  <span class="token punctuation">\</span>
  <span class="token operator">&amp;&amp;</span> <span class="token function">git</span> submodule update --init <span class="token punctuation">\</span>
  <span class="token operator">&amp;&amp;</span> cargo build -p jupiter-dev --all-features --release

<span class="token comment"># Check the command benchmark works fine</span>
./target/release/jupiter-dev benchmark -p pallet_template -e wasm_bls_12_381_add

</code></pre></div><p>Then, run the benchmark scripts like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 1. Under the jupiter repo</span>
<span class="token comment"># 2. Has compiled the release version jupiter-dev</span>
./target/benchmark.sh
</code></pre></div><p><strong>Our benchmark result on ubuntu LTS 20.04. Time is measured in µs</strong></p> <table><thead><tr><th>memory</th> <th>processor</th></tr></thead> <tbody><tr><td>64GiB System memory</td> <td>AMD Ryzen 9 5900X 12-Core Processor</td></tr></tbody></table> <table><thead><tr><th>Curve</th> <th>Operation</th> <th>Native Time(µs)</th> <th>WASM Time(µs)</th> <th>Speed(Native/WASM)</th></tr></thead> <tbody><tr><td>bls12_377</td> <td>add</td> <td>9.588</td> <td>29.02</td> <td>~3x</td></tr> <tr><td>(~9.5x)</td> <td>mul</td> <td>183.1</td> <td>1893</td> <td>~10x</td></tr> <tr><td></td> <td>pairing_two</td> <td>1732</td> <td>15310</td> <td>~7x</td></tr> <tr><td>bls12_381</td> <td>add</td> <td>13.9</td> <td>28.31</td> <td>~2x</td></tr> <tr><td>(~10x)</td> <td>mul</td> <td>177.1</td> <td>1879</td> <td>~10x</td></tr> <tr><td></td> <td>pairing_two</td> <td>1438</td> <td>14770</td> <td>~10x</td></tr> <tr><td>bn254</td> <td>add</td> <td>5.631</td> <td>16.05</td> <td>~3x</td></tr> <tr><td>(~5x)</td> <td>mul</td> <td>107.7</td> <td>534.3</td> <td>~5x</td></tr> <tr><td></td> <td>pairing_two</td> <td>1150</td> <td>5061</td> <td>~5x</td></tr> <tr><td>bw6_761</td> <td>add</td> <td>26.9</td> <td>92.94</td> <td>~4x</td></tr> <tr><td>(~13x)</td> <td>mul</td> <td>956.8</td> <td>14330</td> <td>~15x</td></tr> <tr><td></td> <td>pairing_two</td> <td>5715</td> <td>60960</td> <td>~10x</td></tr></tbody></table> <ul><li>ADD: Test the addition of two generators by the test cases from arkworks.</li> <li>MUL: Test a random number with the size of a private key and multiply the generator by the test cases from arkworks.</li> <li>Pairing:  Test <code>bilinearity: e(s * a, b) = e(s * b, a)</code> by using arkworks to generate test data.</li></ul> <h2 id="_3-provide-and-benchmark-groth16-verifier-in-ink-layer"><a href="#_3-provide-and-benchmark-groth16-verifier-in-ink-layer" class="header-anchor">#</a> 3. Provide and benchmark Groth16 Verifier  in ink! layer</h2> <h3 id="_3-1-introduction-of-groth16-verification"><a href="#_3-1-introduction-of-groth16-verification" class="header-anchor">#</a> 3.1 Introduction of Groth16 Verification</h3> <ul><li>Source：<a href="https://github.com/patractlabs/megaclite/blob/master/crates/curve/arkworks/src/groth16/verify.rs" target="_blank" rel="noopener noreferrer">megaclite/blob/master/crates/curve/arkworks/src/groth16/verify.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Test cases：<a href="https://github.com/patractlabs/megaclite/blob/master/tests/src/arkworks/bench.rs" target="_blank" rel="noopener noreferrer">megaclite/blob/master/tests/src/arkworks/bench.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><a href="https://eprint.iacr.org/2016/260.pdf" target="_blank" rel="noopener noreferrer">gronth16<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is currently the zero-knowledge proof algorithm with the highest verification efficiency (only four pairings are required) and the smallest proof size, so we prefer to choose Groth16 proof system, its verification illustration is as follows:</p> <p><img src="https://i.imgur.com/MoEKfTK.png" alt=""></p> <p>In the paper, we can see that the core of verification is an equation:</p> <p><img src="https://i.imgur.com/GBIEHmE.png" alt=""></p> <p>For the convenience of use in the project implementation, the underlying pairing algorithm provide batch pairing calculation and accumulation, so we need to make a conversion:</p> <p><img src="https://i.imgur.com/r9MZOmr.png" alt=""></p> <p>It can be seen from the formula that four Pairings, l times ADD and MUL operation (related to the actual circuit) are required, and finally, the result of the four pairings will return true or false.</p> <h3 id="_3-2-expose-megaclite-basic-units-for-ink-contract-to-call-through-chain-extension"><a href="#_3-2-expose-megaclite-basic-units-for-ink-contract-to-call-through-chain-extension" class="header-anchor">#</a> 3.2 Expose Megaclite basic units for ink! contract to call through chain-extension</h3> <ul><li>Chain extension example: <a href="https://github.com/patractlabs/jupiter/blob/features/runtime-interfaces/primitives/chain-extension/src/lib.rs" target="_blank" rel="noopener noreferrer">jupiter/blob/features/runtime-interfaces/primitives/chain-extension/src/lib.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Test case：<a href="https://github.com/patractlabs/jupiter/blob/features/runtime-interfaces/pallets/template/src/tests.rs" target="_blank" rel="noopener noreferrer">jupiter/blob/features/runtime-interfaces/pallets/template/src/tests.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Our allocation for Megaclite function id in chain extension:</p> <table><thead><tr><th>curve</th> <th>add</th> <th>mul</th> <th>pairing</th></tr></thead> <tbody><tr><td>bls12_377</td> <td>0x01000000</td> <td>0x01000001</td> <td>0x01000002</td></tr> <tr><td>bls12_381</td> <td>0x01000010</td> <td>0x01000011</td> <td>0x01000012</td></tr> <tr><td>bn254</td> <td>0x01000020</td> <td>0x01000021</td> <td>0x01000022</td></tr> <tr><td>bw6_761</td> <td>0x01000030</td> <td>0x01000031</td> <td>0x01000032</td></tr></tbody></table> <p>The corresponding interface of Megaclite supports chain extension (called from ink! contract) through conditional compilation or directly executes related functions.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">//! https://github.com/patractlabs/megaclite/blob/master/crates/curve/arkworks/src/lib.rs</span>
<span class="token comment">/// Call curve functions using chain extensions</span>
<span class="token attribute attr-name">#[cfg(feature = <span class="token string">&quot;ink&quot;</span>)]</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">call</span><span class="token punctuation">(</span>func_id<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token namespace">ink_env<span class="token punctuation">::</span></span><span class="token function">call_chain_extension</span><span class="token punctuation">(</span>func_id<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/// Call curve functions directly</span>
<span class="token attribute attr-name">#[cfg(not(feature = <span class="token string">&quot;ink&quot;</span>))]</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">call</span><span class="token punctuation">(</span>func_id<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token keyword">match</span> func_id <span class="token punctuation">{</span>
        <span class="token number">0x01000000</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bls12_377<span class="token punctuation">::</span></span><span class="token class-name">Bls12_377</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">add</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000010</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bls12_381<span class="token punctuation">::</span></span><span class="token class-name">Bls12_381</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">add</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000020</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bn254<span class="token punctuation">::</span></span><span class="token class-name">Bn254</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">add</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000030</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bw6_761<span class="token punctuation">::</span></span><span class="token constant">BW6_761</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">add</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000001</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bls12_377<span class="token punctuation">::</span></span><span class="token class-name">Bls12_377</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">mul</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000011</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bls12_381<span class="token punctuation">::</span></span><span class="token class-name">Bls12_381</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">mul</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000021</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bn254<span class="token punctuation">::</span></span><span class="token class-name">Bn254</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">mul</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000031</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bw6_761<span class="token punctuation">::</span></span><span class="token constant">BW6_761</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">mul</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000002</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bls12_377<span class="token punctuation">::</span></span><span class="token class-name">Bls12_377</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">pairings</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>b2b<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000012</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bls12_381<span class="token punctuation">::</span></span><span class="token class-name">Bls12_381</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">pairings</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>b2b<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000022</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bn254<span class="token punctuation">::</span></span><span class="token class-name">Bn254</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">pairings</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>b2b<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">0x01000032</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token namespace">ark_bw6_761<span class="token punctuation">::</span></span><span class="token constant">BW6_761</span> <span class="token keyword">as</span> <span class="token class-name">CurveBasicOperations</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token function">pairings</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>b2b<span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">Error</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">ErrorKind</span><span class="token punctuation">::</span><span class="token class-name">Other</span><span class="token punctuation">,</span> <span class="token string">&quot;Invalid function id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token operator">?</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-3-call-megaclite-basic-units-in-ink-contract-to-provide-groth16-verifier"><a href="#_3-3-call-megaclite-basic-units-in-ink-contract-to-provide-groth16-verifier" class="header-anchor">#</a> 3.3 Call Megaclite basic units in ink! contract to provide Groth16 Verifier</h3> <ul><li>Source: <a href="https://github.com/patractlabs/metis/tree/master/groth16/lib.rs" target="_blank" rel="noopener noreferrer">metis/tree/master/groth16/lib.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">dependencies.curve</span><span class="token punctuation">]</span>
<span class="token key property">package</span> <span class="token punctuation">=</span> <span class="token string">&quot;megaclite-arkworks&quot;</span>
<span class="token key property">git</span> <span class="token punctuation">=</span> <span class="token string">&quot;https://github.com/patractlabs/megaclite&quot;</span>
<span class="token key property">features</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;ink&quot;</span> <span class="token punctuation">]</span>
</code></pre></div><p>Enable chain extension interfaces of Megaclite by using <code>ink</code> feautre.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// ink! contract</span>
<span class="token attribute attr-name">#[ink(message)]</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">bls12_377_verify</span><span class="token punctuation">(</span>
    <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span>
    vk_gamma_abc<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    vk<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    proof<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    public_inputs<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token namespace">groth16<span class="token punctuation">::</span></span><span class="token function">verify</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Bls12_377</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>vk_gamma_abc<span class="token punctuation">,</span> <span class="token operator">&amp;</span>vk<span class="token punctuation">,</span> <span class="token operator">&amp;</span>proof<span class="token punctuation">,</span> <span class="token operator">&amp;</span>public_inputs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="_3-4-benchmark-of-groth16-verifier"><a href="#_3-4-benchmark-of-groth16-verifier" class="header-anchor">#</a> 3.4 Benchmark of Groth16 Verifier</h2> <ul><li>Source: <a href="https://github.com/patractlabs/jupiter/blob/19a1fb3a21e04a5e14b33a0f25c6f10e059cc6ea/pallets/template/src/benchmarking.rs#L68" target="_blank" rel="noopener noreferrer">jupiter pallets/template/src/benchmarking.rs#L68<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>You can build Jupiter by using the same way of above，but we need to pass  <code>groth16</code>  to  <code>scripts/benchmark.sh</code></p> <div class="language- extra-class"><pre class="language-text"><code># 1. Under the jupiter repo
# 2. Has compiled the release version jupiter-dev
./target/benchmark.sh groth16
</code></pre></div><p>Our MiMC-Based Groth16 Verify Benchmark Results:</p> <ul><li>mimc rounds : 322</li></ul> <table><thead><tr><th>Curve</th> <th>Native Time(µs)</th> <th>WASM Time(µs)</th> <th>Speed(Native/WASM)</th></tr></thead> <tbody><tr><td>bls12_377</td> <td>40860</td> <td>60550</td> <td>~1.5x</td></tr> <tr><td>bls12_381</td> <td>39120</td> <td>58400</td> <td>~1.5x</td></tr> <tr><td>bn254</td> <td>30760</td> <td>36800</td> <td>~1.2x</td></tr> <tr><td>bw6_761</td> <td>63798</td> <td>172900</td> <td>~2.7x</td></tr></tbody></table> <blockquote><p>NOTE: The implementation of MiMC-Based Groth16 Verifier here is that when Megaclite is imported into the contract, the verify function of ADD, MUL, Pairing can be run by calling the chain extension.
Test contract: https://github.com/patractlabs/metis/blob/master/groth16/lib.rs</p></blockquote> <h2 id="_4-conclusion-of-native-version-and-wasm-version"><a href="#_4-conclusion-of-native-version-and-wasm-version" class="header-anchor">#</a> 4. Conclusion of Native version and WASM version</h2> <p>According to the test results of the basic units , there is 5-7 times gap between the performance of the WASM version and the Native version. But, <strong>according to the test results of upper-level ink! contract for MiMC Groth16 Verifier, the speed only has little difference, and the time consumption (36-170ms) is acceptable for the block producer.</strong></p> <p>The WASM version does not need to modify the Host Calls in Native layer, so Megaclite will continue to develop the future roadmap in WASM layer, and suspend the development direction of the Native layer, leaving the native layer design to ParityTech and W3F Research. In addition, Jupiter will integrate Megaclite in runtime and ink! to provide a public online test environment.</p> <h2 id="_5-more-library-contracts-built-by-ink"><a href="#_5-more-library-contracts-built-by-ink" class="header-anchor">#</a> 5. More library contracts built by ink!</h2> <h3 id="_5-1-mimc-based-merkle-tree"><a href="#_5-1-mimc-based-merkle-tree" class="header-anchor">#</a> 5.1 MiMC-based Merkle Tree</h3> <ul><li>MiMC ：<a href="https://github.com/patractlabs/megaclite/blob/master/crates/merkle-tree/src/mimc.rs" target="_blank" rel="noopener noreferrer">megaclite/blob/master/crates/merkle-tree/src/mimc.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Merkle Tree: <a href="https://github.com/patractlabs/megaclite/blob/master/crates/merkle-tree/src/merkle_tree.rs" target="_blank" rel="noopener noreferrer">megaclite/blob/master/crates/merkle-tree/src/merkle_tree.rs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>MiMC implements a hash algorithm based on Field on the elliptic curve of alt_bn128, so its circuit implementation in the prove system of ZKP (based on the alt_bn128 curve) is very friendly.</p> <p>The mimc implementation is shown in the figure below, using Sponge mode instantiated by MiMC permutation with a fixed key.</p> <p><img src="https://i.imgur.com/Rg2zjPW.png" alt=""></p> <p>Source code:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> <span class="token keyword">mut</span> r <span class="token operator">=</span> in_k<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span>in_x<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">=</span> <span class="token operator">&amp;</span>r <span class="token operator">+</span> in_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">mimc_pe7</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> in_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>in_seed<span class="token punctuation">,</span> round_count<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In snark setting , MiMC-n/n block-cipher usually use Even-Mansour mode</p> <p><img src="https://i.imgur.com/aCExnKY.png" alt=""></p> <p>Our MiMC-p/p  with exponent of 7, so:</p> <p><img src="https://i.imgur.com/fqD85VQ.png" alt=""></p> <p>Source code:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> <span class="token keyword">mut</span> keccak <span class="token operator">=</span> <span class="token class-name">Keccak</span><span class="token punctuation">::</span><span class="token function">v256</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token keyword">mut</span> received <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0u8</span><span class="token punctuation">;</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
keccak<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">.</span><span class="token function">to_bytes_be</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
keccak<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> received<span class="token punctuation">)</span><span class="token punctuation">;</span>
c <span class="token operator">=</span> <span class="token constant">U256</span><span class="token punctuation">::</span><span class="token function">from_bytes_be</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>received<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span><span class="token punctuation">;</span>

<span class="token comment">// x = (x + c_i + k)^7</span>
t <span class="token operator">=</span> <span class="token operator">&amp;</span>in_x <span class="token operator">+</span> <span class="token operator">&amp;</span>c <span class="token operator">%</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span> <span class="token operator">+</span> in_k <span class="token operator">%</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span><span class="token punctuation">;</span> <span class="token comment">// t = x + c_i + k</span>
a <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">mulmod</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// t^2</span>
a <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">mulmod</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mulmod</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
in_x <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">mulmod</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token constant">SCALAR_FIELD</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// t^7</span>
</code></pre></div><h3 id="_5-2-eddsa-verifier"><a href="#_5-2-eddsa-verifier" class="header-anchor">#</a> 5.2 EdDSA verifier</h3> <ul><li>Source code：<a href="https://github.com/patractlabs/megaclite/tree/master/crates/eddsa" target="_blank" rel="noopener noreferrer">megaclite/tree/master/crates/eddsa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>It is built on <a href="https://z.cash/technology/jubjub/" target="_blank" rel="noopener noreferrer">JubJub curve<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Jubjub is the <a href="https://en.wikipedia.org/wiki/Twisted_Edwards_curve" target="_blank" rel="noopener noreferrer">twisted Edwards curve<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>-u^2 + v^2 = 1 + d.u^2.v^2</code> of rational points over <code>GF(q)</code> with a subgroup of prime order <code>r</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>q = 21888242871839275222246405745257275088548364400416034343698204186575808495617
r = 21888242871839275222246405745257275088696311157297823662689037894645226208583
</code></pre></div><p>The choice of <code>GF(q)</code> is made to be the scalar field of the Bn254 elliptic curve construction.</p> <p>It also implements ETEC (Extened Twisted Edwards coordinate). In the Extended coordinate system, it can provide faster addition operations. In the Projective coordinate system, it can avoid inversion operations and provide faster double operations.</p> <p>The core verification algorithm of EdDSA signature is as follows:</p> <p><img src="https://i.imgur.com/clDEIqR.png" alt=""></p> <p>Where (s, R) is the signature, Pk is the public key, and h is the hash value of the message. Because R is generated by the private key and the message hash, EdDSA is also a deterministic signature algorithm.</p> <p>Source code:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>lhs<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">scalar_mult</span><span class="token punctuation">(</span><span class="token constant">GENERATE</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">GENERATE</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token function">hash_to_u256</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pk_x<span class="token punctuation">,</span> pk_y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">scalar_mult</span><span class="token punctuation">(</span>public_key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> public_key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">let</span> <span class="token punctuation">[</span>r_x<span class="token punctuation">,</span> r_y<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
       <span class="token keyword">let</span> etec_point <span class="token operator">=</span> <span class="token function">etec_add</span><span class="token punctuation">(</span>
           <span class="token operator">&amp;</span><span class="token function">point_to_etec</span><span class="token punctuation">(</span>r_x<span class="token punctuation">,</span> r_y<span class="token punctuation">,</span> <span class="token class-name">Q</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token operator">&amp;</span><span class="token function">point_to_etec</span><span class="token punctuation">(</span>pk_x<span class="token punctuation">,</span> pk_y<span class="token punctuation">,</span> <span class="token class-name">Q</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token operator">&amp;</span><span class="token operator">*</span><span class="token class-name">Q</span><span class="token punctuation">,</span>
           <span class="token operator">&amp;</span><span class="token constant">JUBJUB_A</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token operator">&amp;</span><span class="token constant">JUBJUB_D</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">etec_to_point</span><span class="token punctuation">(</span>etec_point<span class="token punctuation">,</span> <span class="token class-name">Q</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">return</span> lhs <span class="token operator">==</span> rhs<span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token boolean">false</span>
</code></pre></div><h2 id="_5-recap-of-verification-of-megaclite-v0-1"><a href="#_5-recap-of-verification-of-megaclite-v0-1" class="header-anchor">#</a> 5. Recap of verification of Megaclite v0.1</h2> <ul><li><s>Provide more on-chain underlying cryptography support than Ethereum. The current stage includes two curves : alt_bn128 and bls12_381</s></li> <li><s>Integrate ADD, MUL, Paring units under Runtime layer, and provide them to Runtime applications through Runtime-Interface, and further provide them to WASM contract applications through Contract-Seal</s></li> <li><s>Through Pallet and Ink! contract libraries, providing more higher-level verification and crypto tools than Ethereum, improving execution efficiency and reducing development costs</s></li> <li><s>Provide off-chain cryptography toolbox through Rust SDK</s></li> <li><s>Provide typical sample applications through Ink! sample contracts</s></li></ul> <p>We will propose v0.2 and v0.3 later after some time for research.</p></div></section> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/patractlabs/substrate-contracts-book/edit/master/en/zkmega/reports/v0.1Report.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/2/2021, 6:29:47 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/substrate-contracts-book/en/zkmega/benchmark.html" class="prev">
            Benchmark
          </a></span> <span class="next"><a href="/substrate-contracts-book/en/zkmega/reports/v0.2Report.html">
            Report for zkMega v0.2（original Megaclite v0.2 )
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_1-recap-of-megaclite-s-development-plan-v0-1-v0-3" class="sidebar-link reco-side-_1-recap-of-megaclite-s-development-plan-v0-1-v0-3" data-v-70334359>1. Recap of Megaclite’s development plan (v0.1 ~ v0.3)</a></li><li class="level-2" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_2-support-and-benchmark-basic-units-in-native-layer-and-wasm-layer" class="sidebar-link reco-side-_2-support-and-benchmark-basic-units-in-native-layer-and-wasm-layer" data-v-70334359>2. Support and benchmark basic units in Native layer and WASM layer.</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_2-1-encapsulate-crypto-units-of-the-four-curves-from-arkworks" class="sidebar-link reco-side-_2-1-encapsulate-crypto-units-of-the-four-curves-from-arkworks" data-v-70334359>2.1 Encapsulate crypto units of the four curves from arkworks</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_2-2-import-megaclite-through-host-calls-in-native-layer" class="sidebar-link reco-side-_2-2-import-megaclite-through-host-calls-in-native-layer" data-v-70334359>2.2 Import Megaclite through host calls in Native layer.</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_2-3-import-megaclite-as-runtime-library-in-wasm-layer" class="sidebar-link reco-side-_2-3-import-megaclite-as-runtime-library-in-wasm-layer" data-v-70334359>2.3 Import Megaclite as Runtime library in WASM layer</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_2-4-benchmark-of-basic-units" class="sidebar-link reco-side-_2-4-benchmark-of-basic-units" data-v-70334359>2.4 Benchmark of basic units</a></li><li class="level-2" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_3-provide-and-benchmark-groth16-verifier-in-ink-layer" class="sidebar-link reco-side-_3-provide-and-benchmark-groth16-verifier-in-ink-layer" data-v-70334359>3. Provide and benchmark Groth16 Verifier  in ink! layer</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_3-1-introduction-of-groth16-verification" class="sidebar-link reco-side-_3-1-introduction-of-groth16-verification" data-v-70334359>3.1 Introduction of Groth16 Verification</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_3-2-expose-megaclite-basic-units-for-ink-contract-to-call-through-chain-extension" class="sidebar-link reco-side-_3-2-expose-megaclite-basic-units-for-ink-contract-to-call-through-chain-extension" data-v-70334359>3.2 Expose Megaclite basic units for ink! contract to call through chain-extension</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_3-3-call-megaclite-basic-units-in-ink-contract-to-provide-groth16-verifier" class="sidebar-link reco-side-_3-3-call-megaclite-basic-units-in-ink-contract-to-provide-groth16-verifier" data-v-70334359>3.3 Call Megaclite basic units in ink! contract to provide Groth16 Verifier</a></li><li class="level-2" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_3-4-benchmark-of-groth16-verifier" class="sidebar-link reco-side-_3-4-benchmark-of-groth16-verifier" data-v-70334359>3.4 Benchmark of Groth16 Verifier</a></li><li class="level-2" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_4-conclusion-of-native-version-and-wasm-version" class="sidebar-link reco-side-_4-conclusion-of-native-version-and-wasm-version" data-v-70334359>4. Conclusion of Native version and WASM version</a></li><li class="level-2" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_5-more-library-contracts-built-by-ink" class="sidebar-link reco-side-_5-more-library-contracts-built-by-ink" data-v-70334359>5. More library contracts built by ink!</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_5-1-mimc-based-merkle-tree" class="sidebar-link reco-side-_5-1-mimc-based-merkle-tree" data-v-70334359>5.1 MiMC-based Merkle Tree</a></li><li class="level-3" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_5-2-eddsa-verifier" class="sidebar-link reco-side-_5-2-eddsa-verifier" data-v-70334359>5.2 EdDSA verifier</a></li><li class="level-2" data-v-70334359><a href="/substrate-contracts-book/en/zkmega/reports/v0.1Report.html#_5-recap-of-verification-of-megaclite-v0-1" class="sidebar-link reco-side-_5-recap-of-verification-of-megaclite-v0-1" data-v-70334359>5. Recap of verification of Megaclite v0.1</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/substrate-contracts-book/assets/js/app.0512fc9b.js" defer></script><script src="/substrate-contracts-book/assets/js/3.7c35afa4.js" defer></script><script src="/substrate-contracts-book/assets/js/1.293685b3.js" defer></script><script src="/substrate-contracts-book/assets/js/134.9e9d0921.js" defer></script>
  </body>
</html>
