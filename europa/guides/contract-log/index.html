<!doctype html>
<html lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<title data-react-helmet="true">Europa contract execution log | Substrate Contracts Book</title><meta data-react-helmet="true" property="og:url" content="https://docs.patract.io/substrate-contracts-book/europa/guides/contract-log"><meta data-react-helmet="true" name="docusaurus_locale" content="zh"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Europa contract execution log | Substrate Contracts Book"><meta data-react-helmet="true" name="description" content="Here is the structure for recording contract execution information in the current Europa pallet-contract:"><meta data-react-helmet="true" property="og:description" content="Here is the structure for recording contract execution information in the current Europa pallet-contract:"><link data-react-helmet="true" rel="shortcut icon" href="/substrate-contracts-book/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.patract.io/substrate-contracts-book/europa/guides/contract-log"><link data-react-helmet="true" rel="alternate" href="https://docs.patract.io/substrate-contracts-book/europa/guides/contract-log" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://docs.patract.io/substrate-contracts-book/en/europa/guides/contract-log" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.patract.io/substrate-contracts-book/europa/guides/contract-log" hreflang="x-default"><link rel="stylesheet" href="/substrate-contracts-book/assets/css/styles.4aa6c65a.css">
<link rel="preload" href="/substrate-contracts-book/assets/js/runtime~main.ab95248f.js" as="script">
<link rel="preload" href="/substrate-contracts-book/assets/js/main.6bf865d6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/substrate-contracts-book/"><img src="/substrate-contracts-book/img/logo.svg" alt="Substrate Contracts Book" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/substrate-contracts-book/img/logo.svg" alt="Substrate Contracts Book" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a href="https://www.patract.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>主页<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://blog.patract.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/patractlabs/substrate-contracts-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>中文</span></span></a><ul class="dropdown__menu"><li><a href="/substrate-contracts-book/europa/guides/contract-log" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">中文</a></li><li><a href="/substrate-contracts-book/en/europa/guides/contract-log" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/">Summary</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#">介绍</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/contracts/introduction">Substrate 合约书</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/contracts/overview">合约综述</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/contracts/model">合约模型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/contracts/language">合约语言</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/contracts/wasm_first_step">Wasm简要介绍</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ink!</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ask!</a></li><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/solang/introduction">Solang</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Redspot</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Europa</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Get Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/intro/overview">Europa Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/intro/europa-ui">Europa UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/intro/europa-cli">Europa CLI</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Guides</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/guides/architecture">Architeture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/guides/implementation">Contract Pallet Implementation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/guides/custom-rpcs">Custom RPCs and commands</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/substrate-contracts-book/europa/guides/contract-log">Europa contract execution log</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/guides/backtrace">Europa&#x27;s Wasm Backtrace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/guides/debug-example">Europa debugging example</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/guides/wasm-executor">Europa Wasm executor</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Chain Extensions</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/europa/extensions/custom-chain-extensions">Custom ChainExtensions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Reports</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">zkMega</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Himalia</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metis</a></li><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/carpo/introduction">Carpo</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Elara</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Jupiter</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">PatraStore</a></li><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/patract/introduction">Patract</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Europa contract execution log</h1></header><p>Here is the structure for recording contract execution information in the current Europa <code>pallet-contract</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/// Record the contract execution context.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub struct NestedRuntime {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// Current depth</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    depth: usize,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The current contract execute result</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ext_result: ExecResultTrace,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The value in sandbox successful result</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        sandbox_result_ok: Option&lt;ReturnValue&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// Who call the current contract</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    caller: AccountId32,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The account of the current contract</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self_account: Option&lt;AccountId32&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The input selector</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    selector: Option&lt;HexVec&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The input arguments</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    args: Option&lt;HexVec&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The value in call or the endowment in instantiate</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    value: u128,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The gas limit when this contract is called</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gas_limit: Gas,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The gas left when this contract return</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gas_left: Gas,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The host function call stack</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    env_trace: EnvTraceList,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The error in wasm</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    wasm_error: Option&lt;WasmErrorWrapper&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// The trap in host function execution</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    trap_reason: Option&lt;TrapReason&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /// Nested contract execution context</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    nest: Vec&lt;NestedRuntime&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The log example corresponding to this structure is as follows.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">: NestedRuntime </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ext_result: </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">success</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ExecReturnValue </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> flags: </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">, data:  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    caller: d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">5GrwvaEF</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self_account: 0144d6fc570d7bddda6f8e36141f179cd172324599b556ef514193f3105865f6 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">5C6NMXaS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    selector: 0x9bae9d5e,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    args: 0x40420f00000000000000000000000000,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    value: </span><span class="token number" style="color:rgb(247, 140, 108)">10000000000000000</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gas_limit: </span><span class="token number" style="color:rgb(247, 140, 108)">200000000000</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gas_left: </span><span class="token number" style="color:rgb(247, 140, 108)">190018947968</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    env_trace: </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        seal_input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Some</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">0x9bae9d5e40420f00000000000000000000000000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        seal_caller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Some</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">0xd43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       seal_set_storage</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">((</span><span class="token variable" style="color:rgb(191, 199, 213)">Some</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable number" style="color:rgb(247, 140, 108)">0x0300000001000000000000000000000000000000000000000000000000000000</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token variable" style="color:rgb(191, 199, 213)"> Some</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable number" style="color:rgb(247, 140, 108)">0x000000000000000000000000</span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sandbox_result_ok: Value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        I32</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    nest: </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="log-field-description"></a>Log field description<a class="hash-link" href="#log-field-description" title="Direct link to heading">#</a></h2><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>1: NestedRuntime</td><td>Call the contract execution log with a depth of 1.</td></tr><tr><td>ext_result</td><td>The execution result of the contract at the <code>pallet-contract</code> level, there are two  cases: <code>[success]</code> and <code>[failed]</code>. <code>[success]</code> can only indicate that the execution was successful at the <code>pallet-contract</code> level, but the business logic of the contract itself may throw an Error. The data value in <code>ExecResultValue {flag:0, data: 0x...}</code> may be the return value of the contract, or the enumeration value of Error defined in the contract. <code>[failed]</code> will be followed by an <code>ExecError {.. }</code>, the error message is defined in <code>pallet-contracts</code>.</td></tr><tr><td>caller</td><td>The caller of this contract may be the user or another contract account. When the value is <code>0x000...</code>, it is called by RPC.</td></tr><tr><td>self_account</td><td>Current contract account.</td></tr><tr><td>selector</td><td>The function identifier passed to the contract, and the corresponding relationship can be queried in the metadata.json of the contract.</td></tr><tr><td>args</td><td>The parameters passed to the contract calling function.</td></tr><tr><td>value</td><td>Transfer amount to the current contract.</td></tr><tr><td>gas_limit</td><td>The maximum amount of gas that can be used by the current contract.</td></tr><tr><td>gas_left</td><td>The amount of gas remaining when exiting the current contract.</td></tr><tr><td>env_trace</td><td>During the execution of the current contract, the call stack of host_function gives the parameters of each function in detail. Take seal_call as an example. If the input is Some(xxx) and the output is empty, then there may be an error in the process of calling each other between the contracts.</td></tr><tr><td>trap_reason</td><td>The reason for trap encountered during host_function execution.<br> Return &amp; Termination &amp; Restoration: It is the normal exit strategy executed by the contract, not Error. <br>SupervisorError: DispatchError defined in <code>pallet_contracts</code>.</td></tr><tr><td>wasm_error</td><td>If a Wasm execution error occurs in the contract, the Wasm call stack will be printed in this field. If and only if <code>ext_result</code> is <code>[failed]</code>.</td></tr><tr><td>sandbox_result_ok</td><td>If there is no <code>trap</code> and no <code>wasm_error</code> during the execution of host_function, then the contract is considered to be executed successfully and this field is printed. This field carries a <code>ReturnValue</code> information. In <code>ink!</code>, if the value returned is not 0, then an Error defined in <code>ink!</code> may have occurred, and the corresponding  <a href="https://github.com/paritytech/ink/blob/abd5cf14c0883cb2d5acf81f2277aeec330aa843/crates/lang/src/error.rs#L66-L80" target="_blank" rel="noopener noreferrer">DispatchError</a> needs to be queried.</td></tr><tr><td>nest</td><td>Contract log of nested calls. If the current contract calls other contracts, the execution log of the called contract will be nested in this field.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="contract-nested-call"></a>Contract nested call<a class="hash-link" href="#contract-nested-call" title="Direct link to heading">#</a></h2><p>Examples of mutual calls between contracts are as follows.</p><ul><li><p>In contract A, call contract C after calling contract B.</p><p><img src="/substrate-contracts-book/assets/images/call_other_1-eb688f8f77489cd94eea42116f9aac41.png"></p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">1: NestedRuntime {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self_account: A,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    nest:[</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        2: NestedRuntime {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            self_account: B,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            nest:[],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        2: NestedRuntime {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            self_account: C,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            nest:[],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><p>In contract A, call contract B, in contract B, call contract C</p><p><img src="/substrate-contracts-book/assets/images/call_other_2-f9b33fdd6032c00de5986de19d8229c3.png"></p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">: NestedRuntime </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self_account: A,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        nest:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">: NestedRuntime </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        self_account: B,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        nest:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain">: NestedRuntime </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                self_account: C,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                nest:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">  </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="env_trace"></a><code>env_trace</code>:<a class="hash-link" href="#env_trace" title="Direct link to heading">#</a></h2><p>Indicates that during the execution of the current layer of the contract, each time host_function is called in the contract Wasm execution, a record will be added to the list here. Because all host_functions and the definitions in <a href="https://github.com/paritytech/substrate/blob/master/frame/contracts/src/wasm/runtime.rs#L610" target="_blank" rel="noopener noreferrer"><code>define_env!</code> in the <code>pallet contracts</code> module</a> are related, so tracing <code>env_trace</code> can trace the process of interacting with <code>pallet contracts</code> during the execution of the current Wasm contract. </p><p>For example, if following thing appears in <code>env_trace</code>:</p><ul><li><code>seal_call</code>: It means that there is a contract call contract situation in the current contract. According to the order in which <code>seal_call</code> appears in <code>env_trace</code>, it can correspond to <code>nest</code> to calculate the state before and after the contract calls the contract.</li><li><code>seal_get_storage</code>&amp;<code>seal_set_storage</code>: It means that data read and write occurred in the contract. Through these two interfaces, it is possible to intercept and count the data read and write during the execution of the current contract, and the data size calculated by <strong><code>seal_set_storage</code> can also be used to infer the storage size required by <code>rent</code>. </strong></li><li><code>seal_deposit_event</code>: indicates that the event is printed in the contract. Here you can intercept the content of each event separately, instead of getting a unified event at the end. And the following text will use an example to surface that Europa can quickly locate the bug in the <code>host_function</code>.</li></ul><p>On the other hand, the statistics of <code>env_trace</code> are relatively <strong>fine-grained</strong>. For example, if there are multiple possible errors in <code>host_function</code>, when an error occurs, all the information before the error will be retained, so it can be located to the place where the problem occurred during the execution of <code>host_function</code>.</p><p>And if there is an error in <code>host_function</code> that causes the contract to end execution, <code>env_trace</code> records the last error <code>host_function</code> call, so you can directly locate which <code>host_function</code> caused the contract execution exception.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="trap_reason"></a><code>trap_reason</code>:<a class="hash-link" href="#trap_reason" title="Direct link to heading">#</a></h2><p>According to the definition of <code>TrapReason</code> in <code>pallet contracts</code>, <code>trap_reason</code> can be divided into 2 categories:</p><ol><li><code>Return</code> &amp; <code>Termination</code> &amp; <code>Restoration</code>: indicates that the contract exit is the design of <code>pallet contracts</code>, not an internal error. This type of trap indicates that the contract is executed normally and is not an error.</li><li><code>SupervisorError</code>: Indicates that an error occurred during the execution of the contract calling host_function.</li></ol><p>Therefore, the current Europa log printing design is designed to record whenever <code>trap_reason</code> appears. On the other hand, <code>trap_reason</code> may not always appear during the execution of the contract. Combining the design of <code>pallet contracts</code> and <code>ink!</code>, there is a case where the successful execution of the contract or the execution failure in the <code>ink!</code> layer does not generate <code>trap_reason</code>. Therefore, in addition to recording <code>trap_reason</code>, Europa also <strong>records the results returned by the Wasm executor after execution, which is recorded with <code>sandbox_result_ok</code>. </strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sandbox_result_ok"></a><code>sandbox_result_ok</code>:<a class="hash-link" href="#sandbox_result_ok" title="Direct link to heading">#</a></h2><p>The value of <code>sandbox_result_ok</code> represents the result of the contract after the Wasm executor is executed. This value could have been recorded as <code>sandbox_result</code>, including correct and incorrect conditions. However, due to the limitations of Rust and combined with the business logic of <code>pallet contracts</code>, only the result of <code>sandbox_result</code> is kept as <code>Ok</code> here. <strong>For log printing, Europa is designed to print <code>sandbox_result_ok</code> only when trap_reason is the first case, as information to assist in judging contract execution. </strong></p><p><code>sandbox_result_ok</code> is the Wasm executor <a href="https://github.com/paritytech/substrate/blob/712085115cdef4a79a66747338c920d6ba4e479f/frame/contracts/src/wasm/mod.rs#L155-L156" target="_blank" rel="noopener noreferrer">result after calling <code>invoke</code></a> After the processing of <code>to_execution_result</code>, if there is no <code>trap_reason</code>, the result of <code>Ok(..)</code> is [discarded](<a href="https://github.com/paritytech/substrate/blob/712085115cdef4a79a66747338c920d6ba4e479f" target="_blank" rel="noopener noreferrer">https://github.com/paritytech/substrate/blob/712085115cdef4a79a66747338c920d6ba4e479f</a> /frame/contracts/src/wasm/runtime.rs#L366-L368). But in fact there are two situations here:</p><ol><li>An error occurred in <code>ink!</code>: According to the implementation of <code>ink!</code>, before calling the functions wrapped by the contract <code>#[ink(message)]</code> and <code>#[ink(constructor)]</code>, the input The process of decoding and matching <code>selector</code>. If an error occurs during this process, the contract will return <a href="https://github.com/paritytech/ink/blob/abd5cf14c0883cb2d5acf81f2277aeec330aa843/crates/lang/src/error.rs#L22" target="_blank" rel="noopener noreferrer">error code <code>DispatchError</code></a>. But for the Wasm executor, the Wasm code is executed normally, so the result will be returned, including this error code. <strong>This contract execution process is an error situation. </strong></li><li>The return value of <code>#[ink(message)]</code> is defined as <code>()</code>: According to the implementation of <code>ink!</code>, if the return value type is <code>()</code>, <code>seal_reason</code> will not be called, so it will not Contains <code>trap_reason</code>. <strong>This contract execution process is an correct situation. </strong></li></ol><p>Since <code>ink!</code> is only a contract implementation that runs on <code>pallet contracts</code>, other implementations may have different rules, so currently <code>sandbox_result_ok</code> is only used to assist in determining the execution of the <code>ink!</code> contract, the value is <a href="https://github.com/paritytech/substrate/blob/712085115cdef4a79a66747338c920d6ba4e479f/primitives/wasm-interface/src/lib.rs#L462-L467" target="_blank" rel="noopener noreferrer"><code> ReturnValue</code></a>. Among them, if the <code>&lt;num&gt;</code> part of <code>ReturnValue::Value(&lt;num&gt;)</code> of the log is not 0, it means that there may be an error in the execution of <code>ink!</code>. You can use <code>ink!</code> for <a href="https://github.com/paritytech/ink/blob/abd5cf14c0883cb2d5acf81f2277aeec330aa843/crates/lang/src/error.rs#L66-L80" target="_blank" rel="noopener noreferrer"><code>DispatchError</code> The error code</a> determines the error.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/patractlabs/substrate-contracts-book/edit/master/docs/europa/guides/contract-log.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/substrate-contracts-book/europa/guides/custom-rpcs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Custom RPCs and commands</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/substrate-contracts-book/europa/guides/backtrace"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Europa&#x27;s Wasm Backtrace »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#log-field-description" class="table-of-contents__link">Log field description</a></li><li><a href="#contract-nested-call" class="table-of-contents__link">Contract nested call</a></li><li><a href="#env_trace" class="table-of-contents__link"><code>env_trace</code>:</a></li><li><a href="#trap_reason" class="table-of-contents__link"><code>trap_reason</code>:</a></li><li><a href="#sandbox_result_ok" class="table-of-contents__link"><code>sandbox_result_ok</code>:</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/substrate-contracts-book/assets/js/runtime~main.ab95248f.js"></script>
<script src="/substrate-contracts-book/assets/js/main.6bf865d6.js"></script>
</body>
</html>