"use strict";(self.webpackChunksubstrate_contracts_book=self.webpackChunksubstrate_contracts_book||[]).push([[5757],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),l=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(n),m=r,h=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2563:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return p},metadata:function(){return l},toc:function(){return c},default:function(){return u}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],s={},p="Report for Redspot v0.3",l={unversionedId:"redspot/reports/v0.3Report",id:"redspot/reports/v0.3Report",isDocsHomePage:!1,title:"Report for Redspot v0.3",description:"5 weeks ago, Patract Hub launched a Treasury Proposal #23 for Redspot v0.3, and now we have finished all the development works on time. For a quick review, you can visit our website at https://redspot.patract.io.",source:"@site/docs/redspot/reports/v0.3Report.md",sourceDirName:"redspot/reports",slug:"/redspot/reports/v0.3Report",permalink:"/substrate-contracts-book/redspot/reports/v0.3Report",editUrl:"https://github.com/patractlabs/substrate-contracts-book/docs/redspot/reports/v0.3Report.md",version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Report for Redspot v0.2",permalink:"/substrate-contracts-book/redspot/reports/v0.2Report"},next:{title:"Report for Redspot v0.4",permalink:"/substrate-contracts-book/redspot/reports/v0.4Report"}},c=[{value:"Summary of Redspot\u2019s Future Plan\uff1a",id:"summary-of-redspots-future-plan\uff1a",children:[]},{value:"New features in Redspot v0.3",id:"new-features-in-redspot-v03",children:[{value:"TypeScript upgrade",id:"typescript-upgrade",children:[]},{value:"Optimization of plug-in system",id:"optimization-of-plug-in-system",children:[]},{value:"Add artifacts object",id:"add-artifacts-object",children:[]},{value:"Refactor the network object",id:"refactor-the-network-object",children:[]},{value:"Add @redspot/chai plug-in",id:"add-redspotchai-plug-in",children:[]},{value:"Add @redspot/gas-reporter plug-in",id:"add-redspotgas-reporter-plug-in",children:[]},{value:"Add @redspot/jupiter plug-in",id:"add-redspotjupiter-plug-in",children:[]},{value:"Redspot&#39;s official website and tutorials",id:"redspots-official-website-and-tutorials",children:[]},{value:"Other optimizations",id:"other-optimizations",children:[]}]},{value:"Recap of v0.3 verification",id:"recap-of-v03-verification",children:[]}],d={toc:c};function u(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"report-for-redspot-v03"},"Report for Redspot v0.3"),(0,o.kt)("p",null,"5 weeks ago, ",(0,o.kt)("a",{parentName:"p",href:"https://patract.io"},"Patract Hub")," launched a ",(0,o.kt)("a",{parentName:"p",href:"https://polkadot.polkassembly.io/treasury/23"},"Treasury Proposal #23")," for Redspot v0.3, and now we have finished all the development works on time. For a quick review, you can visit our website at ",(0,o.kt)("a",{parentName:"p",href:"https://redspot.patract.io/"},"https://redspot.patract.io"),"."),(0,o.kt)("p",null,"Redspot v0.1 has the basic functions of compiling contracts, testing contracts and deploying contracts. The v0.2 version refactored the bottom layer, allowing Redspot to have better scalability, adding TypeScript support, a flexible plug-in system, and simpler and more intuitive logic. Redspot v0.2 already has a very complete basic framework, so v0.3 mainly upgrades the plug-in system on the basis of v0.2, adds chai matcher, sample plug-ins, and supplements Redspot's official website and documentation tutorials."),(0,o.kt)("h2",{id:"summary-of-redspots-future-plan\uff1a"},"Summary of Redspot\u2019s Future Plan\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"v0.1: Build core functions based on Truffle framework")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"v0.2: Migrate to Hardhat framework to enhance the extensibility of plugins and add some features to provide a smoother development workflow")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"v0.3: Promote Redspot and allow more contract developers to participate. Combine the features of Substrate to add various plug-ins, such as Waffle, Jupiter, Gas report.")),(0,o.kt)("li",{parentName:"ul"},"v0.4: Provide Typescript type support for contracts (similar to Typechain), integrate multi-language SDK, etc.")),(0,o.kt)("h2",{id:"new-features-in-redspot-v03"},"New features in Redspot v0.3"),(0,o.kt)("p",null,"Now let us show the design and implementation of v0.3, and how to run and verify it. Like v0.2, you can install a template project locally via ",(0,o.kt)("inlineCode",{parentName:"p"},"npx redspot-new erc20"),". For specific usage methods, please refer to ",(0,o.kt)("a",{parentName:"p",href:"https://polkadot.polkassembly.io/post/156"},"Treasury Report #156")," of v0.2"),(0,o.kt)("h3",{id:"typescript-upgrade"},"TypeScript upgrade"),(0,o.kt)("p",null,"The templates provided by Redspot by default are based on TypeScript, so developers who are not familiar with TypeScript can easily use TypeScript's code hints and type system. In v0.2, if a new plug-in is introduced, and this plug-in extends the type of Redspot Runtime Environment, we need to manually import the type file of the plug-in in the tsconfig.json file so that TypeScript can recognize it correctly. like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'"files": [\n  "./redspot.config.ts"\n  "./node_modules/@redspot/patract/type-extensions.d.ts"\n]\n')),(0,o.kt)("p",null,"We improved this in v0.3. Now the plug-in type file does not need to be set up specially, the type will be automatically imported."),(0,o.kt)("p",null,"Now the types of Redspot are all provided by ",(0,o.kt)("inlineCode",{parentName:"p"},"redspot/types"),", and the plug-in can describe the types of new attributes and interfaces by inheriting RuntimeEnvironment. like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// type-extensions.ts\nimport 'redspot/types';\n\ndeclare module 'redspot/types' {\n  interface RuntimeEnvironment {\n    [pluginName]: {\n      ... // type\n    };\n  }\n}\n")),(0,o.kt)("p",null,"Then import this file ",(0,o.kt)("inlineCode",{parentName:"p"},'import "type-extensions.ts"')," inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"index.js")," of the plugin. In this way, when a plug-in is imported, TypeScript will automatically recognize the type file."),(0,o.kt)("p",null,"We always recommend users to use TypeScript. Redspot uses ",(0,o.kt)("inlineCode",{parentName:"p"},"ts-node")," to run TypeScript code internally. When running scripts or tests, if the value of TS_NODE_TRANSPILE_ONLY is not explicitly set, Redspot will defaultly set TS_NODE_TRANSPILE_ONLY to true. This can speed up the compilation speed of ts-node and avoid type errors. In Redspot, you can write TypeScript in the same way as JavaScript. Users will not have additional learning burden, but they can directly enjoy the benefits of code hints brought by TypeScript."),(0,o.kt)("h3",{id:"optimization-of-plug-in-system"},"Optimization of plug-in system"),(0,o.kt)("p",null,"In v0.2 we need to use ",(0,o.kt)("inlineCode",{parentName:"p"},"usePlugin")," to introduce a plugin. In v0.3, the introduction of plugins has become more natural. Only the plugins you need in ",(0,o.kt)("inlineCode",{parentName:"p"},"require")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"import")," in ",(0,o.kt)("inlineCode",{parentName:"p"},"redspot.config.ts"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"import '@redspot/patract'\n// or\nrequire('@redspot/patract')\n")),(0,o.kt)("p",null,"Now the plug-in does not need to export a function, but directly calls extendEnvironment to extend the Runtime Environment:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"import { extendEnvironment } from 'redspot/config';\n\nextendEnvironment((env) => {\n  env.patract = ...\n});\n")),(0,o.kt)("p",null,"We have abandoned The plug-in ",(0,o.kt)("inlineCode",{parentName:"p"},"internalTask")," and changed to ",(0,o.kt)("inlineCode",{parentName:"p"},"subtask"),". ",(0,o.kt)("inlineCode",{parentName:"p"},"subtask")," supports complex types and no longer needs ",(0,o.kt)("inlineCode",{parentName:"p"},"stringified"),"."),(0,o.kt)("h3",{id:"add-artifacts-object"},"Add artifacts object"),(0,o.kt)("p",null,"In v0.2, you need to import the module ",(0,o.kt)("inlineCode",{parentName:"p"},"redspot/plugins")," to get the ",(0,o.kt)("inlineCode",{parentName:"p"},"readAbi")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"readWasm")," functions:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'const { readAbi, readWasm } = require("redspot/plugins")\n\nreadAbi(env.paths.artifacts, contractName) // get abi\nreadWasm(env.paths.artifacts, contractName) // get wasm\n')),(0,o.kt)("p",null,"Now the Redspot Runtime Environment will export an artifacts object, which contains artifact-related methods."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const { artifacts } = env\n\nartifacts.readAbi(contractName)  // get abi\nartifacts.readWasm(contractName)  // get wasm\nartifacts.saveArtifact(path) // save artifact \n")),(0,o.kt)("p",null,"get the abi file at the same time\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const { artifacts } = env\n\nartifacts.readAbiSync(contractName)  // get abi\nartifacts.readWasmSync(contractName)  // get wasm\n")),(0,o.kt)("h3",{id:"refactor-the-network-object"},"Refactor the network object"),(0,o.kt)("p",null,"In v0.2, ",(0,o.kt)("inlineCode",{parentName:"p"},"env.network")," will import a ",(0,o.kt)("inlineCode",{parentName:"p"},"provider")," object compatible with ",(0,o.kt)("inlineCode",{parentName:"p"},"Polkadot.js"),"'s ",(0,o.kt)("inlineCode",{parentName:"p"},"ProviderInterface")," type. Now we have extended the network object and added more methods and properties."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"export interface Network {\n  name: string;\n  config: NetworkConfig;\n  provider: WsProvider;\n  api: ApiPromise;\n  registry: Registry;\n  keyring: Keyring;\n  getSigners(): Promise<Signer[]>;\n  createSigner(pair: KeyringPair): Signer;\n  gasLimit?: BN;\n  explorerUrl?: string;\n  utils: {\n    encodeSalt(\n      salt?: Uint8Array | string | null,\n      signer?: Signer\n    ): Promise<Uint8Array>;\n  };\n}\n")),(0,o.kt)("p",null,"Now we are more compatible with ",(0,o.kt)("inlineCode",{parentName:"p"},"polkadot.js"),". ",(0,o.kt)("inlineCode",{parentName:"p"},"api"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"registry"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"keyring")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"provider")," are all from ",(0,o.kt)("inlineCode",{parentName:"p"},"polkadot.js"),", Redspot will automatically handle the initialization and setting of these objects."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"signer")," object returned by ",(0,o.kt)("inlineCode",{parentName:"p"},"getSigners")," is compatible with the ",(0,o.kt)("inlineCode",{parentName:"p"},"signer")," in ",(0,o.kt)("inlineCode",{parentName:"p"},"polkadot.js")," and can be directly used for transaction signing. If you want to create a ",(0,o.kt)("inlineCode",{parentName:"p"},"signer"),", it is also very simple by calling the createSigner method:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const uri =\n  'bottom drive obey lake curtain smoke basket hold race lonely fit walk//Alice';\n\nconst signer = createSigner(network.keyring.createFromUri(uri));\n\n")),(0,o.kt)("h3",{id:"add-redspotchai-plug-in"},"Add @redspot/chai plug-in"),(0,o.kt)("p",null,"This plug-in is used to simplify the writing of test cases. The values returned by all APIs in ",(0,o.kt)("inlineCode",{parentName:"p"},"polkadot.js")," are not basic types, so it is impossible to simply judge whether they are equal. Many times you need to write: ",(0,o.kt)("inlineCode",{parentName:"p"},"expect(account.toString()).to.equal('5GHs.....')"),". If you write like this: ",(0,o.kt)("inlineCode",{parentName:"p"},"expect(account.eq('5GHs....')).to.true"),", you will lose the detailed error message provided by the test framework. ",(0,o.kt)("inlineCode",{parentName:"p"},"@redspot/chai")," solves this problem, it covers the ",(0,o.kt)("inlineCode",{parentName:"p"},"eq")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"equal")," matchers of ",(0,o.kt)("inlineCode",{parentName:"p"},"chai")," internally. example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"expect(Uint8Array.from([0x11,0x22])).to.equal('0x1122'); // true\nexpect(Uint8Array.from([0x11,0x22])).to.equal('0x2122'); // false\nexpect(new BN('10000000000000000')).to.equal(10000000000000000n); // true\nexpect(new BN('10000000000000000')).to.equal('10000000000000000'); // true\nexpect(AccountId).to.equal('5GHs....'); // true\n")),(0,o.kt)("p",null,"For contracts, if you use the ",(0,o.kt)("inlineCode",{parentName:"p"},"@redspot/patract")," plugin, you can easily perform contract event matching, simple and easy to read:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// Detects if a transfer event is sent for the transaction\nawait expect(contract.tx.transfer(receiver.address, 7))\n    .to.emit(contract, 'Transfer') \n    \n// Detects if the transaction sends a transfer event with the specified parameters\nawait expect(contract.tx.transfer(receiver.address, 7))\n  .to.emit(contract, 'Transfer')\n  .withArgs(sender.address, receiver.address, 7);\n")),(0,o.kt)("p",null,"You can also detect the change in the balance of the ",(0,o.kt)("inlineCode",{parentName:"p"},"erc20")," contract:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"await expect(() =>\n  contract.tx.transfer(receiver.address, 7)\n).to.changeTokenBalance(contract, receiver, 7);\n\nawait expect(() =>\n  contract.tx.transfer(receiver.address, 7)\n).to.changeTokenBalances(contract, [contract.signer, receiver], [-7, 7]);\n")),(0,o.kt)("p",null,"There are also some tool adapters:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"expect(...).to.properAddress\nexpect(...).to.properHex\n")),(0,o.kt)("p",null,"If you want to import the ",(0,o.kt)("inlineCode",{parentName:"p"},"@redspot/chai")," plugin, you only need to add ",(0,o.kt)("inlineCode",{parentName:"p"},'import "@redspot/chai"')," in ",(0,o.kt)("inlineCode",{parentName:"p"},"redspot.config.ts"),". When the plugin is imported, it will automatically add the matcher to chai."),(0,o.kt)("p",null,"Now the complete test case of ",(0,o.kt)("inlineCode",{parentName:"p"},"erc20")," is as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"import BN from 'bn.js';\nimport { expect } from 'chai';\nimport { patract, network, artifacts } from 'redspot';\n\nconst { getContractFactory, getRandomSigner } = patract;\n\nconst { api, getSigners } = network;\n\ndescribe('ERC20', () => {\n  after(() => {\n    return api.disconnect();\n  });\n\n  async function setup() {\n    const one = new BN(10).pow(new BN(api.registry.chainDecimals));\n    const signers = await getSigners();\n    const Alice = signers[0];\n    const sender = await getRandomSigner(Alice, one.muln(100));\n    const contractFactory = await getContractFactory('erc20', sender);\n    const contract = await contractFactory.deploy('new', '1000');\n    const abi = artifacts.readAbi('erc20');\n    const receiver = await getRandomSigner();\n    \n    return { sender, contractFactory, contract, abi, receiver, Alice, one };\n  }\n\n  it('Assigns initial balance', async () => {\n    const { contract, sender } = await setup();\n    sender.pair.publicKey\n    const result = await contract.query.balanceOf(sender.address);\n    expect(result.output).to.equal(1000);\n  });\n\n  it('Assigns initial balance', async () => {\n    const { contract, sender } = await setup();\n    const result = await contract.query.balanceOf(sender.address);\n    expect(result.output).to.equal(1000);\n  });\n\n  it('Transfer adds amount to destination account', async () => {\n    const { contract, receiver } = await setup();\n\n    await expect(() =>\n      contract.tx.transfer(receiver.address, 7)\n    ).to.changeTokenBalance(contract, receiver, 7);\n\n    await expect(() =>\n      contract.tx.transfer(receiver.address, 7)\n    ).to.changeTokenBalances(contract, [contract.signer, receiver], [-7, 7]);\n  });\n\n  it('Transfer emits event', async () => {\n    const { contract, sender, receiver } = await setup();\n\n    await expect(contract.tx.transfer(receiver.address, 7))\n      .to.emit(contract, 'Transfer')\n      .withArgs(sender.address, receiver.address, 7);\n  });\n\n  it('Can not transfer above the amount', async () => {\n    const { contract, receiver } = await setup();\n\n    await expect(contract.tx.transfer(receiver.address, 1007)).to.not.emit(\n      contract,\n      'Transfer'\n    );\n  });\n\n  it('Can not transfer from empty account', async () => {\n    const { contract, Alice, one, sender } = await setup();\n\n    const emptyAccount = await getRandomSigner(Alice, one.muln(10));\n\n    await expect(\n      contract.tx.transfer(sender.address, 7, {\n        signer: emptyAccount\n      })\n    ).to.not.emit(contract, 'Transfer');\n  });\n});\n")),(0,o.kt)("h3",{id:"add-redspotgas-reporter-plug-in"},"Add @redspot/gas-reporter plug-in"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"@redspot/gas-reporter")," will print the gas consumption at the end of each test. The plugin covers the Test task. When calling test, it adds a reporter to mocha."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"subtask(TASK_TEST_RUN_MOCHA_TESTS).setAction(\n  async (args: any, rse, runSuper) => {\n    const options = getOptions(rse);\n\n    if (options.enabled) {\n      mochaConfig = rse.config.mocha || {};\n      mochaConfig.reporter = GasReporter;\n      mochaConfig.reporterOptions = options;\n      rse.config.mocha = mochaConfig;\n    }\n\n    return runSuper();\n  }\n);\n")),(0,o.kt)("p",null,"Input ",(0,o.kt)("inlineCode",{parentName:"p"},"npx redspot test"),",and will get results:"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://user-images.githubusercontent.com/7029338/101343840-7700ab00-38e9-11eb-80a0-c6b6d38a9640.png"},(0,o.kt)("img",{parentName:"a",src:"https://user-images.githubusercontent.com/7029338/101343840-7700ab00-38e9-11eb-80a0-c6b6d38a9640.png",alt:"img"}))),(0,o.kt)("p",null,"The gas-reporter will monitor the block at the beginning of the test, and process the data of all blocks at the end of the test, and get the contract transaction. Then use the transaction data of the contract to call ",(0,o.kt)("inlineCode",{parentName:"p"},"contract.call")," to get the estimated gas consumption value. Due to the estimated gas value, it is not very accurate. So gas-reporter will also analyze the events in the block to get the weight value of the contract transaction. Both gas and weight will be displayed after the test case is completed."),(0,o.kt)("h3",{id:"add-redspotjupiter-plug-in"},"Add @redspot/jupiter plug-in"),(0,o.kt)("p",null,"This is a sample plug-in that shows how Redspot adapts some chains. This plugin modifies the contract address calculation method, changing the random salt to account nonce. And it only takes effect for the jupiter chain."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"extendEnvironment((env) => {\n  env.network.utils.encodeSalt = async function encodeSalt(\n    salt?: string | Uint8Array | null,\n    signer?: Signer\n  ): Promise<Uint8Array> {\n    if (!signer) throw new Error('Need Signer');\n\n    const accountInfo = await signer.api.query.system.account(signer.address);\n\n    const runtimeVersion = signer.api.runtimeVersion;\n\n    const isJupiter = runtimeVersion.specName\n      .toString()\n      .toLowerCase()\n      .includes('jupiter');\n\n    if (!isJupiter) return env.network.utils.encodeSalt(salt, signer);\n\n    const nonce = accountInfo.nonce.toNumber();\n\n    return salt instanceof Bytes ? salt : compactAddLength(numberToU8a(nonce));\n  };\n});\n")),(0,o.kt)("p",null,"We get the ",(0,o.kt)("inlineCode",{parentName:"p"},"specname")," through the ",(0,o.kt)("inlineCode",{parentName:"p"},"runtimeversion")," of the chain. Then judge whether the ",(0,o.kt)("inlineCode",{parentName:"p"},"specname")," is Jupiter, and if not, return to the original ",(0,o.kt)("inlineCode",{parentName:"p"},"encodeSalt")," method. Our subsequent judgment process is integrated into the Redspot framework."),(0,o.kt)("p",null,"We will add more chain plugins in the future, such as ",(0,o.kt)("inlineCode",{parentName:"p"},"europa"),". It has some special RPCs to facilitate contract testing. Such as the function of resetting the state of the block."),(0,o.kt)("h3",{id:"redspots-official-website-and-tutorials"},"Redspot's official website and tutorials"),(0,o.kt)("p",null,"We designed and developed the Redspot homepage, filled with some documents and tutorials. You can view it here ",(0,o.kt)("a",{parentName:"p",href:"https://redspot.patract.io/"},"https://redspot.patract.io")),(0,o.kt)("p",null,"Our homepage\uff1a ",(0,o.kt)("a",{parentName:"p",href:"https://user-images.githubusercontent.com/69485494/101435288-f84f5080-3970-11eb-972a-07fd17b264e5.png"},(0,o.kt)("img",{parentName:"a",src:"https://user-images.githubusercontent.com/69485494/101435288-f84f5080-3970-11eb-972a-07fd17b264e5.png",alt:"img"}))),(0,o.kt)("p",null,"Our Toturial page\uff1a ",(0,o.kt)("a",{parentName:"p",href:"https://user-images.githubusercontent.com/69485494/101435444-3cdaec00-3971-11eb-8911-406a41ec96bd.png"},(0,o.kt)("img",{parentName:"a",src:"https://user-images.githubusercontent.com/69485494/101435444-3cdaec00-3971-11eb-8911-406a41ec96bd.png",alt:"img"}))),(0,o.kt)("p",null,"Our Documentation page: ",(0,o.kt)("a",{parentName:"p",href:"https://user-images.githubusercontent.com/69485494/101437908-179cac80-3976-11eb-8577-497304f50d47.png"},(0,o.kt)("img",{parentName:"a",src:"https://user-images.githubusercontent.com/69485494/101437908-179cac80-3976-11eb-8577-497304f50d47.png",alt:"img"}))),(0,o.kt)("h3",{id:"other-optimizations"},"Other optimizations"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"We have adjusted the Redspot release process, and Redspot will now be released automatically through CI. Now, like polkadot.js, x.y.1 will be the stable version of Redspot, and x.y.2-z will be the test version of Redspot. We also added the vers parameter to Redspot-template. If you want to install a historical version of Redspot, you can do by this:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npx redspot-new erc20 --vers ^0.4.2-15\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"We have sorted out the types of Redspot's framework, and now all types can be found in ",(0,o.kt)("inlineCode",{parentName:"li"},"redspot/types"),"."),(0,o.kt)("li",{parentName:"ul"},"We have moved some exported functions and properties of ",(0,o.kt)("inlineCode",{parentName:"li"},"@redspot/patract")," to network to facilitate other plugins to extend.")),(0,o.kt)("h2",{id:"recap-of-v03-verification"},"Recap of v0.3 verification"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"M1: Homepage and API docs page development"))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"View Redspot's homepage ",(0,o.kt)("a",{parentName:"p",href:"https://redspot.patract.io/"},"https://redspot.patract.io"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"M2: Write detailed tutorials and documents"))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"View Redspot's tutorials ",(0,o.kt)("a",{parentName:"p",href:"https://redspot.patract.io/en/tutorial/"},"https://redspot.patract.io/en/tutorial/")," and ",(0,o.kt)("a",{parentName:"p",href:"https://redspot.patract.io/en/plugins/"},"https://redspot.patract.io/en/plugins/")," .\nCreate a new Redspot project and view the typescript code hints in the project.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"M3: Upgrade Redspot's plugin system"))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Optimizations and upgrades of redspot have been demonstrated above.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"M4: Develop Jupiter plugin and Gas Report v0.2 plugin"))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"The gas-reports plug-in has been added to the default template. Just run ",(0,o.kt)("inlineCode",{parentName:"p"},"npx redspot test")," to get the gas-reporter results.\nYou can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"@redspot/jupiter")," plugin by importing the jupiter plugin ",(0,o.kt)("inlineCode",{parentName:"p"},"import \u2018@redspot/jupiter\u2019"),". If you are accessing the jupiter network, the contract address generated at this time is calculated through account nonce.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("del",{parentName:"li"},"M5: Develop assertion library"))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Check the test case for sample erc20 template")))}u.isMDXComponent=!0}}]);