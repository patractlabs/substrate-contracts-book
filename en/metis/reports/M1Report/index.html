<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<title data-react-helmet="true">Patract&#x27;s proposal about Metis (ink! and Ask! Standard Library) | Substrate Contracts Book</title><meta data-react-helmet="true" property="og:url" content="https://docs.patract.io/substrate-contracts-book/en/metis/reports/M1Report"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Patract&#x27;s proposal about Metis (ink! and Ask! Standard Library) | Substrate Contracts Book"><meta data-react-helmet="true" name="description" content="Metis will be the Wasm contract standard library developed by Patract Labs. Patract Labs will work with community forces to formulate various Wasm contract standards, develop corresponding implementations of ink! and Ask! versions, and conduct audits by professional institutions."><meta data-react-helmet="true" property="og:description" content="Metis will be the Wasm contract standard library developed by Patract Labs. Patract Labs will work with community forces to formulate various Wasm contract standards, develop corresponding implementations of ink! and Ask! versions, and conduct audits by professional institutions."><link data-react-helmet="true" rel="shortcut icon" href="/substrate-contracts-book/en/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.patract.io/substrate-contracts-book/en/metis/reports/M1Report"><link data-react-helmet="true" rel="alternate" href="https://docs.patract.io/substrate-contracts-book/metis/reports/M1Report" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://docs.patract.io/substrate-contracts-book/en/metis/reports/M1Report" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.patract.io/substrate-contracts-book/metis/reports/M1Report" hreflang="x-default"><link rel="stylesheet" href="/substrate-contracts-book/en/assets/css/styles.4aa6c65a.css">
<link rel="preload" href="/substrate-contracts-book/en/assets/js/runtime~main.4c486d39.js" as="script">
<link rel="preload" href="/substrate-contracts-book/en/assets/js/main.32f2285c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/substrate-contracts-book/en/"><img src="/substrate-contracts-book/en/img/logo.svg" alt="Substrate Contracts Book" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/substrate-contracts-book/en/img/logo.svg" alt="Substrate Contracts Book" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">My Site</b></a><a href="https://www.patract.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://blog.patract.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/patractlabs/substrate-contracts-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/substrate-contracts-book/metis/reports/M1Report" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">ä¸­æ–‡</a></li><li><a href="/substrate-contracts-book/en/metis/reports/M1Report" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/en/">Summary</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#">Introduction</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/contracts/introduction">Substrate contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/contracts/overview">Contract overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/contracts/model">Contract model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/contracts/language">Contract language</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/contracts/wasm_first_step">Brief introduction of Wasm</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ink!</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ask!</a></li><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/en/solang/introduction">Solang</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Redspot</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Europa</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">zkMega</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Himalia</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Metis</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/metis/introduction">Metis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/metis/tokens">ERC20</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/metis/access-control">Access Control</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Reports</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-contracts-book/en/metis/reports">Report for Metis proposals</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/substrate-contracts-book/en/metis/reports/M1Report">Patract&#x27;s proposal about Metis (ink! and Ask! Standard Library)</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/en/carpo/introduction">Carpo</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Elara</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Jupiter</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">PatraStore</a></li><li class="menu__list-item"><a class="menu__link" href="/substrate-contracts-book/en/patract/introduction">Patract</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Patract&#x27;s proposal about Metis (ink! and Ask! Standard Library)</h1></header><p><a href="https://github.com/patractlabs/metis" target="_blank" rel="noopener noreferrer">Metis</a> will be the Wasm contract standard library developed by Patract Labs. Patract Labs will work with community forces to formulate various Wasm contract standards, develop corresponding implementations of ink! and Ask! versions, and conduct audits by professional institutions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="0-motivation"></a>0. Motivation<a class="hash-link" href="#0-motivation" title="Direct link to heading">#</a></h2><p>We believe that in the Wasm contract ecosystem, a development library similar to Openzeppelin-contracts is very necessary. This is Metis. For the sake of simplicity and readability, the patterns and meta-language provided by this library should be as consistent with Openzeppelin-contracts as possible, so as to reduce the burden on developers and effectively absorb the experience accumulated in the Solidity ecosystem.</p><p>But you need to realize that the Wasm contract development based on ink! and Ask! is very different from the EVM contract development based on Solidity. Wasm&#x27;s mature system support allows developers to use a variety of different languages and tools to develop smart contracts. Based on these mature or rapid iteration platforms, developers can enjoy a large number of underlying facilities support and development experience accumulation, but different languages and tools often have different considerations and trade-offs. This means that developers will use completely different codes to express the same mechanism and design, which will bring huge communication costs and mental burdens to the community.</p><p>Faced with such problems, we need to summarize and accumulate the implementation model in the development of smart contracts. This idea was introduced in the book &quot;Implementation Patterns&quot; by Kent Beck. The purpose of summarizing the implementation mode is to clearly and accurately express the developer&#x27;s intentions and ideas through these clear patterns, so that &quot;code that others can understand&quot; can be implemented. In contract development, this idea is very important.</p><p>From Openzeppelin-contracts, we can see that it summarizes several implementation models in the development of smart contracts, such as the &quot;contract expansion model&quot; based on the Solidity inheritance grammar. These implementation models are valuable experience accumulated in the Solidity ecology. Of course, different languages have different ways of practicing these modes. Metis will implement these modes and provide corresponding support on different platforms. For example, in Rust, it is obvious that you cannot directly use inheritance to implement contract expansion. For this, Metis will provide code implementation examples and provide a series of help libraries to reduce the developer&#x27;s mental cost.</p><p>Metis will be more than just a Wasm contract standard library. We hope that through the practice of Metis, we can fully inherit and absorb previous contract development experience while exploring the best practices of Wasm contract development.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-problem"></a>1. Problem<a class="hash-link" href="#1-problem" title="Direct link to heading">#</a></h2><p>At present, contract-based developers mainly face the following problems:</p><ul><li>Lack of reliable implementation of common contracts (such as ERC20)</li><li>It is difficult to achieve contract combination and expansion similar to the Solidity inheritance mechanism</li><li>Lack of a series of reliable public components to implement contracts</li><li>Lack of experience accumulation and model summary based on ink! development contracts</li></ul><p>The above problems severely limit the current ink!-based contract development ecology. Metis will solve these problems while avoiding the existing problems in Solidity.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-contract-standard-library"></a>2. Contract Standard Library<a class="hash-link" href="#2-contract-standard-library" title="Direct link to heading">#</a></h2><p>Metis will implement a series of common components, similar to the Openzeppelin-contracts development library. These components will be thoroughly tested and code audited. These components will be as consistent as possible with Openzeppelin-contracts, which can reduce the burden on developers and effectively absorb the experience accumulated in the Solidity ecosystem.</p><p>Metis will include the following components:</p><ul><li>Openzeppelin-contracts-like components, including basic Access and Security components, as well as Token and Governance components</li><li>Component developed for ink! contracts, wasm-based contracts can support better abstraction mechanisms, and we can implement more complex and practical components</li><li>Summarizing abstract components from mature contract projects, metis will absorb the experience and accumulation of the community, including both the mature Solidity ecology and emerging blockchain contract projects.</li><li>The expansion of ink! contracts, including basic data structures for different scenarios, etc.</li></ul><p>In the previous version of Metis, we will first implement Openzeppelin-contracts-like components for developers to use. These components include:</p><ul><li>Token: ERC20, ERC721, ERC777, ERC1155 and the expansion contract of the above Token contract</li><li>Access: Ownable, AccessControl, TimelockController</li><li>Security: PullPayment, ReentrancyGuard, Pausable</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-ink-component"></a>3. ink! component<a class="hash-link" href="#3-ink-component" title="Direct link to heading">#</a></h2><p>Most of Metis development libraries are composed of contract components. In Solidity, the introduction of contract components can be implemented based on inheritance. Generally, the contract components will include the following parts:</p><ul><li>Component Storage: The storage state related to the logic of the component itself, these states do not need to be exposed to the outside</li><li>Component Message: The externally-facing Message of the component</li><li>Component Event: The event that the component&#x27;s own logic will  emit</li><li>Component internal interface: an interface for other logic in the contract to call</li></ul><p>For example, common Ownable contracts:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly Solidity"><pre tabindex="0" class="prism-code language-Solidity codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">abstract contract Ownable is Context {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Component Storage</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address private _owner;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Component Event</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Component internal interface</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    modifier onlyOwner() {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Component Event</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function renounceOwnership() public virtual onlyOwner {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If a contract needs to be Ownable, just inherit the contract:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly Solidity"><pre tabindex="0" class="prism-code language-Solidity codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">contract Escrow is Ownable {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Similarly, other components can also have Ownable through inheritance:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly Solidity"><pre tabindex="0" class="prism-code language-Solidity codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">contract Pausable is Ownable {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  function unpause() public onlyOwner whenPaused {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The intention of inheritance here is actually composition rather than an <code>is-a</code> relationship. Although excessive use of inheritance in Solidity will cause many problems, inheritance for specific intentions is still an important way to achieve it.</p><p>In contract development based on ink!, through metis, we can also achieve the same motivation based on generics and traits:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#[metis::contract] // metis contract macro, will use ink_lang::contract auto</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mod flipper {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #[import(ownable)] // flipper import the ownable</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pub struct Flipper {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ownable: ownable::Data&lt;Flipper&gt;, // data by ownable</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        value: bool,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #[ink(event)]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #[metis(ownable)] // TODO: event in ink! will refactor</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pub struct OwnershipTransferred {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    impl Flipper {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pub fn flip(&amp;mut self) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // check owner</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ownable::Impl::ensure_caller_is_owner(self);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            self.value = !self.value;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pub fn renounce_ownership(&amp;mut self) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ownable::Impl::renounce_ownership(self) // owner message</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Metis assists developers to achieve the same function through a series of helper macros. In order to improve the auditability of the contract, here we hope that users clearly implement storage, event and message declarations.</p><p>At the same time, metis has improved the implementation of components:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Storage</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#[metis::component::storage]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub struct Data&lt;E&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">where</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    E: Env,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    owner: Lazy&lt;Option&lt;E::AccountId&gt;&gt;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Event trait</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub trait EventEmit&lt;E: Env&gt;: EnvAccess&lt;E&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Impl trait</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub trait Impl&lt;E: Env&gt;: Storage&lt;E&gt; + EventEmit&lt;E&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // logics</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fn init(&amp;mut self) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.get_mut().set_ownership(&amp;Some(Self::caller()));</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fn renounce_ownership(&amp;mut self) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.ensure_caller_is_owner();</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.emit_event_ownership_transferred(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            self.get().get_ownership().clone(),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            None);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.get_mut().set_ownership(&amp;None);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /// Panic if `owner` is not an owner</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fn ensure_owner(&amp;self, owner: &amp;E::AccountId) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        assert!(&amp;self.get().get_ownership().clone().unwrap() == owner);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Such components can extend their functions by inheriting other components, such as an ERC20 component with the function of destroying tokens:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pub trait Impl&lt;E&gt;: erc20::Impl&lt;E&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">where</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    E: Env,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fn _burn(&amp;mut self, account: &amp;E::AccountId, amount: E::Balance) -&gt; Result&lt;()&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fn burn(&amp;mut self, amount: E::Balance) -&gt; Result&lt;()&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self._burn(&amp;Self::caller(), amount)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fn burn_from(&amp;mut self, account: &amp;E::AccountId, amount: E::Balance) -&gt; Result&lt;()&gt; {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Based on metis, we can implement various contract combination modes implemented by Solidity through inheritance under limited intent, and at the same time, with the help of rust&#x27;s zero-cost abstraction, these abstractions will not bring additional performance consumption.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-overall-roadmap"></a>4. Overall Roadmap<a class="hash-link" href="#4-overall-roadmap" title="Direct link to heading">#</a></h2><p>Metis for ink! is divided into several milestones:</p><ul><li><strong>[M1]</strong> Implement basic component macros and components, improve component testing support, developers can build regular DAPPs based on Metis</li><li><strong>[M2]</strong> Complete component macros, complete component development support, developers can build custom components. Complete the api support corresponding to the metis component.</li><li><strong>[M3]</strong> Rich component library, complete component and API support for governance and financial mechanism, perfect mathematical library suitable for contract development to support DeFi-type contracts that require complex calculations.</li></ul><p>Considering that the current ink! and contract-pallet are still in iteration, some metis features will be implemented based on subsequent improvements, including:</p><ul><li>Contract proxy and upgradeable support will depend on the improvement of subsequent contract calls, by <a href="https://github.com/paritytech/ink/issues/739" target="_blank" rel="noopener noreferrer">739</a>.</li><li>The Event in the component, the Event in the current ink! cannot be independent of the contract, by <a href="https://github.com/paritytech/ink/issues/759" target="_blank" rel="noopener noreferrer">759</a>, the event in the current component is only an early implementation, and it will be refactored based on the improvement of ink! in the future.</li></ul><p>With the richness and completeness of the ink! contract community, metis will further implement more public components and libraries to assist developers in developing large-scale contract projects. Therefore, we may arrange [MR] milestones. It will be developed based on the iterative schedule of ink!</p><ul><li><strong>[MR]</strong> According to the ink!&#x27;s iterative progress, community feedback, contract upgrades, contract proxy and cross-contract call support, refactor Event-related implementations, improve basic components and add development assistance macros to reduce duplication while ensuring auditability Code.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-detailed-timeline-of-m1-3-developers--5-weeks"></a>5. Detailed timeline of M1 (3 developers * 5 weeks)<a class="hash-link" href="#5-detailed-timeline-of-m1-3-developers--5-weeks" title="Direct link to heading">#</a></h2><ul><li>Week 1: <ul><li>M1.1 Design and develop macros that support the development of metis components, and determine the component development paradigm</li><li>M1.2 Design and develop macros that support the introduction of metis components into contracts, and determine the development paradigm for contract expansion and introduction of components</li></ul></li><li>Week 2:<ul><li>M1.3 Design and develop unit test support for components</li><li>M1.4 design and develop integration test support based on Redspot</li></ul></li><li>Week 3:<ul><li>M1.5 Complete the implementation and testing of Access related components</li><li>M1.6 Complete the implementation and testing of Security related components</li></ul></li><li>Week 4:<ul><li>M1.7 Complete the implementation and testing of Token related components</li><li>M1.8 Complete the detailed Metis component design document</li></ul></li><li>Week 5:<ul><li>M1.9 Complete documentation and examples of metis components</li></ul></li></ul><p>Cost of M1 (15 developers * weeks):</p><ul><li>Operating activities: $3000 ( Rent and Devices: $200 per employee * week )</li><li>Developer payments: $28500 ( $1900 per developer * week )</li><li>Total Cost: $31500</li><li>Treasury Proposal: 1166 DOT ($27/DOT)</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6-how-to-verify-m1"></a>6. How to verify M1<a class="hash-link" href="#6-how-to-verify-m1" title="Direct link to heading">#</a></h2><p>Complete the macros and tests related to the metis component, and all the tests can pass. Complete the detailed metis component design document. Complete the implementation and testing of the following contract components, all tests can pass:</p><ul><li>ERC20 and its expansion components (including increasingly issuance, destruction, etc.)</li><li>ERC721 and its expansion components</li><li>ERC777 and its expansion components</li><li>ERC1155 and its expansion components</li><li>Ownable</li><li>AccessControl</li><li>TimelockController</li><li>PullPayment</li><li>ReentrancyGuard</li><li>Pausable</li></ul><p>Complete the documentation and examples of the above contract components.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/patractlabs/substrate-contracts-book/docs/metis/reports/M1Report.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/substrate-contracts-book/en/metis/reports"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Report for Metis proposals</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/substrate-contracts-book/en/carpo/introduction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Carpo Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#0-motivation" class="table-of-contents__link">0. Motivation</a></li><li><a href="#1-problem" class="table-of-contents__link">1. Problem</a></li><li><a href="#2-contract-standard-library" class="table-of-contents__link">2. Contract Standard Library</a></li><li><a href="#3-ink-component" class="table-of-contents__link">3. ink! component</a></li><li><a href="#4-overall-roadmap" class="table-of-contents__link">4. Overall Roadmap</a></li><li><a href="#5-detailed-timeline-of-m1-3-developers--5-weeks" class="table-of-contents__link">5. Detailed timeline of M1 (3 developers * 5 weeks)</a></li><li><a href="#6-how-to-verify-m1" class="table-of-contents__link">6. How to verify M1</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/substrate-contracts-book/en/assets/js/runtime~main.4c486d39.js"></script>
<script src="/substrate-contracts-book/en/assets/js/main.32f2285c.js"></script>
</body>
</html>